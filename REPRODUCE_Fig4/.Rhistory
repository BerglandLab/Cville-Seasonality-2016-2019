geom_errorbar(width = 0.6) +
geom_point(size = 3) +
theme_bw()
feby.dat %<>%
mutate(ex.lab = paste(sp_first, sp_second, sep = "_"))
lm(Count ~ ex.lab, data = feby.dat ) -> model.dat
summary(model.dat)
anova(model.dat)
library(tidyverse)
library(magrittr)
library(reshape2)
library(gmodels)
feby.dat <- read.delim("~/Documents/Bergland_Lab/NC_VA_Summer/2022/Feby/feby.dat.txt")
feby.dat
feby.dat %>%
#filter(Treatment == "Control") %>%
group_by(treat=paste(sp_first,sp_second,Note, sep = "_")) %>%
mutate(treat = case_when(treat == "Mel_NA" ~ "D.mel control",
treat == "Wil_NA" ~ "D.wil control",
treat == "Wil_Mel" ~ "wil->mel",
treat == "Mel_Wil" ~ "mel->wil"
)) %>%
summarise(mean = ci(Count)[1],
uci = ci(Count)[3],
lci = ci(Count)[2]
) %>%
ggplot(aes(
x=treat,
y=mean,
ymin=lci,
ymax = uci
)) +
ylab("Mean Fecundity") +
geom_errorbar(width = 0.6) +
geom_point(size = 3) +
theme_bw()
feby.dat %>%
#filter(Treatment == "Control") %>%
group_by(treat=paste(sp_first,sp_second, sep = "_"), Note) %>%
mutate(treat = case_when(treat == "Mel_NA" ~ "D.mel control",
treat == "Wil_NA" ~ "D.wil control",
treat == "Wil_Mel" ~ "wil->mel",
treat == "Mel_Wil" ~ "mel->wil"
)) %>%
summarise(mean = ci(Count)[1],
uci = ci(Count)[3],
lci = ci(Count)[2]
) %>%
ggplot(aes(
x=treat,
y=mean,
ymin=lci,
ymax = uci
)) +
ylab("Mean Fecundity") +
geom_errorbar(width = 0.6) +
geom_point(size = 3) +
theme_bw()
feby.dat %>%
#filter(Treatment == "Control") %>%
group_by(treat=paste(sp_first,sp_second, sep = "_"), Note) %>%
mutate(treat = case_when(treat == "Mel_NA" ~ "D.mel control",
treat == "Wil_NA" ~ "D.wil control",
treat == "Wil_Mel" ~ "wil->mel",
treat == "Mel_Wil" ~ "mel->wil"
)) %>%
summarise(mean = ci(Count)[1],
uci = ci(Count)[3],
lci = ci(Count)[2]
) %>%
ggplot(aes(
x=treat,
y=mean,
ymin=lci,
ymax = uci,
color=Note
)) +
ylab("Mean Fecundity") +
geom_errorbar(width = 0.6) +
geom_point(size = 3) +
theme_bw()
feby.dat %>%
#filter(Treatment == "Control") %>%
group_by(treat=paste(sp_first,sp_second, sep = "_"), Note) %>%
mutate(treat = case_when(treat == "Mel_NA" ~ "D.mel control",
treat == "Wil_NA" ~ "D.wil control",
treat == "Wil_Mel" ~ "wil->mel",
treat == "Mel_Wil" ~ "mel->wil"
)) %>%
summarise(mean = ci(Count)[1],
uci = ci(Count)[3],
lci = ci(Count)[2]
) %>%
ggplot(aes(
x=treat,
y=mean,
ymin=lci,
ymax = uci,
color=Note
)) +
ylab("Mean Fecundity") +
geom_errorbar(width = 0.1, position=position_dodge(width=0.5)) +
geom_point(size = 3, position=position_dodge(width=0.5)) +
theme_bw()
feby.dat
feby.dat[which(feby.dat$Treatment == "Control" & feby.dat$sp_first == "Mel")]$Note
feby.dat[which(feby.dat$Treatment == "Control" & feby.dat$sp_first == "Mel"),]$Note
feby.dat[which(feby.dat$Treatment == "Control" & feby.dat$sp_first == "Mel"),]$Note = "M"
feby.dat[which(feby.dat$Treatment == "Control" & feby.dat$sp_first == "Wil"),]$Note = "W"
feby.dat %>%
#filter(Treatment == "Control") %>%
group_by(treat=paste(sp_first,sp_second, sep = "_"), Note) %>%
mutate(treat = case_when(treat == "Mel_NA" ~ "D.mel control",
treat == "Wil_NA" ~ "D.wil control",
treat == "Wil_Mel" ~ "wil->mel",
treat == "Mel_Wil" ~ "mel->wil"
)) %>%
summarise(mean = ci(Count)[1],
uci = ci(Count)[3],
lci = ci(Count)[2]
) %>%
ggplot(aes(
x=treat,
y=mean,
ymin=lci,
ymax = uci,
color=Note
)) +
ylab("Mean Fecundity") +
geom_errorbar(width = 0.1, position=position_dodge(width=0.5)) +
geom_point(size = 3, position=position_dodge(width=0.5)) +
theme_bw()
feby.dat %<>%
mutate(ex.lab = paste(sp_first, sp_second, sep = "_"))
lm(Count ~ ex.lab+Note, data = feby.dat ) -> model.dat
summary(model.dat)
anova(model.dat)
load("./Year_to_year_object.Rdata")
?write.table
write.table(filtered_samps_for_analysis,
file = "./samps.forPCA.EffCovFiltered.txt",
append = FALSE, quote = F, sep = "\t",
eol = "\n", na = "NA", dec = ".", row.names = TRUE,
col.names = TRUE, qmethod = c("escape", "double"),
fileEncoding = "")
file.clusters = "/scratch/yey2sn/Overwintering_ms/19.inv.fst/DEST_Sample_clusters.txt"
clust.asg = fread(file.clusters) %>%
dplyr::select(samp1=sampleId, Continental_clusters)
pi.inv <- read.delim("~/Downloads/Pi.CM.W_100000.S_50000.INV.windowed.pi")
View(pi.inv)
pi.inv <- read.delim("~/Downloads/Pi.CM.W_100000.S_50000.INV.windowed.pi")
library(tidyverse)
pi.inv %>% head
pi.inv
ggplot(aes(
x=(BIN_START+BIN_END)/2,
y=PI
)) +
geom_line() +
geom_vline(xintercept = 7702805) +
geom_vline(xintercept = 7710690)
pi.inv %>%
ggplot(aes(
x=(BIN_START+BIN_END)/2,
y=PI
)) +
geom_line() +
geom_vline(xintercept = 7702805) +
geom_vline(xintercept = 7710690)
pi.inv %>%
filter(CHROM == "2L") %>%
ggplot(aes(
x=(BIN_START+BIN_END)/2,
y=PI
)) +
geom_line() +
geom_vline(xintercept = 7702805) +
geom_vline(xintercept = 7710690)
pi.inv <- read.delim("~/Downloads/D.CM.W_100000.S_50000.INV.Tajima.D")
pi.inv
pi.inv %>%
filter(CHROM == "2L") %>%
ggplot(aes(
x=(BIN_START+BIN_END)/2,
y=TajimaD
)) +
geom_line() +
geom_vline(xintercept = 7702805) +
geom_vline(xintercept = 7710690)
pi.inv %>%
filter(CHROM == "2L") %>%
ggplot(aes(
x=(BIN_START,
pi.inv %>%
filter(CHROM == "2L") %>%
ggplot(aes(
x=BIN_START,
y=TajimaD
)) +
geom_line() +
geom_vline(xintercept = 7702805) +
geom_vline(xintercept = 7710690)
D.inv <- read.delim("~/Downloads/D.CM.W_100000.S_50000.INV.Tajima.D")
D.inv %>%
filter(CHROM == "2L") %>%
ggplot(aes(
x=BIN_START,
y=TajimaD
)) +
geom_vline(xintercept = 7702805, color = "red") +
geom_line(size = 1.2) +
q
D.inv %>%
filter(CHROM == "2L") %>%
ggplot(aes(
x=BIN_START,
y=TajimaD)) +
geom_vline(xintercept = 7702805, color = "red") +
geom_line(size = 1.2)
D.inv %>%
filter(CHROM == "2L") %>%
ggplot(aes(
x=BIN_START,
y=TajimaD)) +
geom_vline(xintercept = 7702805, color = "red") +
geom_hline(yintercept = 0) +
geom_hline(yintercept = 1, lintype = "dashed") +
geom_hline(yintercept = -1, lintype = "dashed") +
geom_line(size = 1.2)
D.inv %>%
filter(CHROM == "2L") %>%
ggplot(aes(
x=BIN_START,
y=TajimaD)) +
geom_vline(xintercept = 7702805, color = "red") +
geom_hline(yintercept = 0) +
geom_hline(yintercept = 1, linetype = "dashed") +
geom_hline(yintercept = -1, linetype = "dashed") +
theme_bw() +
geom_line(size = 1.2)
D.std <- read.delim("~/Downloads/D.CM.W_100000.S_50000.STD.Tajima.D")
D.std %>%
filter(CHROM == "2L") %>%
ggplot(aes(
x=BIN_START,
y=TajimaD)) +
geom_vline(xintercept = 7702805, color = "red") +
geom_hline(yintercept = 0) +
geom_hline(yintercept = 1, linetype = "dashed") +
geom_hline(yintercept = -1, linetype = "dashed") +
theme_bw() +
geom_line(size = 1.2)
D.std %>%
filter(CHROM == "2L") %>%
ggplot(aes(
x=BIN_START,
y=TajimaD)) +
geom_vline(xintercept = 7702805, color = "red") +
geom_hline(yintercept = 0) +
geom_hline(yintercept = 1, linetype = "dashed") +
geom_hline(yintercept = -1, linetype = "dashed") +
theme_bw() +
geom_line(size = 1.2, color = "grey")
D.inv
D.inv <- read.delim("~/Downloads/D.CM.W_100000.S_50000.INV.Tajima.D")
D.std <- read.delim("~/Downloads/D.CM.W_100000.S_50000.STD.Tajima.D")
library(tidyverse)
library(magrittr)
D.inv <- read.delim("~/Downloads/D.CM.W_100000.S_50000.INV.Tajima.D")
D.inv %<>% mutate(set = "inv")
D.std <- read.delim("~/Downloads/D.CM.W_100000.S_50000.STD.Tajima.D")
D.std %<>% mutate(set = "std")
rbind(D.inv, D.std) %>%
filter(CHROM == "2L") %>%
ggplot(aes(
x=BIN_START,
y=TajimaD,
color = set)) +
geom_vline(xintercept = 7702805, color = "red") +
geom_hline(yintercept = 0) +
geom_hline(yintercept = 1, linetype = "dashed") +
geom_hline(yintercept = -1, linetype = "dashed") +
theme_bw() +
geom_line(size = 1.1)
rbind(D.inv, D.std) %>%
filter(CHROM == "2L") %>%
ggplot(aes(
x=BIN_START,
y=TajimaD,
color = set)) +
geom_vline(xintercept = 7702805, color = "purple") +
geom_hline(yintercept = 0) +
geom_hline(yintercept = 1, linetype = "dashed") +
geom_hline(yintercept = -1, linetype = "dashed") +
theme_bw() +
geom_line(size = 1.1)
rbind(D.inv, D.std) %>%
filter(CHROM == "2L") %>%
ggplot(aes(
x=BIN_START,
y=TajimaD,
color = set)) +
geom_vline(xintercept = 7702805, color = "purple") +
geom_vline(xintercept = 2225744) +
geom_vline(xintercept = 13154180) +
geom_hline(yintercept = 0) +
geom_hline(yintercept = 1, linetype = "dashed") +
geom_hline(yintercept = -1, linetype = "dashed") +
theme_bw() +
geom_line(size = 1.1)
rbind(D.inv, D.std) %>%
filter(CHROM == "#L") %>%
ggplot(aes(
x=BIN_START,
y=TajimaD,
color = set)) +
geom_vline(xintercept = 3336032, color = "purple") +
geom_hline(yintercept = 0) +
geom_hline(yintercept = 1, linetype = "dashed") +
geom_hline(yintercept = -1, linetype = "dashed") +
theme_bw() +
geom_line(size = 1.1)
rbind(D.inv, D.std) %>%
filter(CHROM == "3L") %>%
ggplot(aes(
x=BIN_START,
y=TajimaD,
color = set)) +
geom_vline(xintercept = 3336032, color = "purple") +
geom_hline(yintercept = 0) +
geom_hline(yintercept = 1, linetype = "dashed") +
geom_hline(yintercept = -1, linetype = "dashed") +
theme_bw() +
geom_line(size = 1.1)
rbind(D.inv, D.std) %>%
filter(CHROM == "2L") %>%
ggplot(aes(
x=BIN_START,
y=TajimaD,
color = set)) +
geom_vline(xintercept = 7702805, color = "purple") +
geom_vline(xintercept = 2225744) +
geom_vline(xintercept = 13154180) +
geom_hline(yintercept = 0) +
geom_hline(yintercept = 1, linetype = "dashed") +
geom_hline(yintercept = -1, linetype = "dashed") +
theme_bw() +
xlim(7e6,8e6) +
geom_line(size = 1.1)
library(tidyverse)
library(magrittr)
library(data.table)
library(foreach)
root <- paste(base, paste("data3", metric, sep = "."), sep = "/")
root <- paste(base, paste("data3", metric, sep = "."), sep = "/")
library(data.table)
library(tidyverse)
library(magrittr)
library(reshape2)
library(foreach)
## load
choice.dat <- fread("/Users/jcbnunez/Downloads/Final_Project_Fly_Count.tsv")
library(tidyverse)
a = c( rep(6970, 13), rep(317, 2) )
1/mean(1/a)
a = c( rep(25000, 13), rep(2500, 2) )
1/mean(1/a)
a = c( rep(25000, 13), rep(1500, 2) )
1/mean(1/a)
rm(list = ls())
library(tidyverse)
library(magrittr)
library(factoextra)
library(FactoMineR)
library(gtools)
library(patchwork)
library(ggalt)
5096167+999-1
step1 %>%
mutate(EFFCOV_j = calc_effcovj(value, nFlies),
EFFCOV_o = calc_effcov_o(value, nFlies),
) %>%
group_by(sampleId) %>%
summarise(MeanEC.j = mean(EFFCOV_j, na.rm = T),
MeanEC.o = mean(EFFCOV_o, na.rm = T),
) -> EFFCOV_samps
calc_effcov_o = function(NomCOV, FlyPool) {
Nc = (1/(2*FlyPool) + 1/NomCOV) - 1
return(Nc)
}
step1 %>%
mutate(EFFCOV_j = calc_effcovj(value, nFlies),
EFFCOV_o = calc_effcov_o(value, nFlies),
) %>%
group_by(sampleId) %>%
summarise(MeanEC.j = mean(EFFCOV_j, na.rm = T),
MeanEC.o = mean(EFFCOV_o, na.rm = T),
) -> EFFCOV_samps
setwd("/Users/jcbnunez/Documents/GitHub/Cville-Seasonality-2016-2019/REPRODUCE_Fig4")
library(tidyverse)
library(reshape2)
library(magrittr)
library(foreach)
library(viridis)
library(data.table)
library(ggridges)
library(broom)
library(ade4)
###save seas data
load("./FST.seasonal.Rdata")
fst.dat.EC$SNP.set %>% unique() -> sets
fst.dat.EC %<>%
mutate(delta_y = abs(year1-year2))
fst.dat.EC
fst.dat.EC %>%
group_by(pop1, delta_y) %>%
summarise(mean.fst = mean(FST) )
fst.dat.EC %>%
group_by(pop1, delta_y, SNP.set) %>%
summarise(mean.fst = mean(FST) )
fst.dat.EC %>%
group_by(pop1, delta_y, SNP.set) %>%
summarise(mean.fst = mean(FST) ) %>%
ggplot(aes(
x=delta_y,
y=mean.fst,
color=SNP.set
)) +
geom_line() +
facet_wrap(~pop1)
cities_to_choose <- c("Munich", "Akaa", "Broggingen", "Odesa", "Charlottesville")
fst.dat.EC %>%
filter(pop1 %in% cities_to_choose) %>%
group_by(pop1, delta_y, SNP.set) %>%
summarise(mean.fst = mean(FST) ) %>%
ggplot(aes(
x=delta_y,
y=mean.fst,
color=SNP.set
)) +
geom_line() +
facet_wrap(~pop1)
fst.dat.EC %>%
filter(pop1 %in% cities_to_choose) %>%
group_by(pop1, delta_y, SNP.set) %>%
summarise(mean.fst = mean(FST) ) %>%
ggplot(aes(
x=delta_y,
y=mean.fst,
color=SNP.set
)) +
geom_line() +
facet_wrap(~pop1) +
scale_color_viridis(discrete = TRUE, option = "D")
fst.dat.EC %>%
filter(pop1 %in% cities_to_choose) %>%
group_by(pop1, delta_y, SNP.set) %>%
summarise(mean.fst = mean(FST) ) %>%
ggplot(aes(
x=delta_y,
y=mean.fst,
color=SNP.set
)) +
geom_line() +
facet_wrap(~pop1, scales = "free") +
scale_color_viridis(discrete = TRUE, option = "D")
fst.dat.EC %>%
filter(pop1 %in% cities_to_choose) %>%
group_by(pop1, delta_y, SNP.set) %>%
summarise(mean.fst = mean(FST) ) %>%
ggplot(aes(
x=delta_y,
y=mean.fst,
color=SNP.set
)) +
geom_line(size = 1.3) +
theme_bw() +
facet_wrap(~pop1, scales = "free") +
scale_color_viridis(discrete = TRUE, option = "D")
fst.dat.EC %>%
filter(pop1 %in% cities_to_choose) %>%
group_by(pop1, delta_y, SNP.set) %>%
summarise(mean.fst = mean(FST) ) %>%
ggplot(aes(
x=delta_y,
y=mean.fst,
color=SNP.set
)) +
geom_line(size = 1.3) +
theme(legend.position = "bottom") +
theme_bw() +
facet_wrap(~pop1, scales = "free", nrow = 1) +
scale_color_viridis(discrete = TRUE, option = "D")
fst.dat.EC %>%
filter(pop1 %in% cities_to_choose) %>%
group_by(pop1, delta_y, SNP.set) %>%
summarise(mean.fst = mean(FST) ) %>%
ggplot(aes(
x=delta_y,
y=mean.fst,
color=SNP.set
)) +
geom_line(size = 1.3) +
theme_bw() +
theme(legend.position = "bottom") +
facet_wrap(~pop1, scales = "free", nrow = 1) +
scale_color_viridis(discrete = TRUE, option = "D")
scale_color_viridis(discrete = TRUE, option = "D") +
scale_color_viridis(discrete = TRUE, option = "D") +
q
scale_color_viridis(discrete = TRUE, option = "D") +
scale_color_viridis(discrete = TRUE, option = "D") +
