xlab(NULL) +
ylab("PCA Dimension 1\nProjection") +
facet_grid(~PC, ncol = 1)
rbind(ms1, ms2) %>%
ggplot(data=., aes(x=as.factor(gt.name), y=mu)) +
geom_errorbar(aes(x=as.factor(gt.name), ymin=mu-1.96*s, ymax=mu+1.96*s), width=.1) +
geom_point() +
theme_bw()  +
xlab(NULL) +
ylab("PCA Dimension 1\nProjection") +
facet_wrap(~PC, ncol = 1)
rbind(ms1, ms2) %>%
ggplot(data=., aes(x=as.factor(gt.name), y=mu)) +
geom_errorbar(aes(x=as.factor(gt.name), ymin=mu-1.96*s, ymax=mu+1.96*s), width=.1) +
geom_point() +
theme_bw()  +
xlab(NULL) +
ylab("PCA Dimension 1\nProjection") +
facet_wrap(~pc, ncol = 1)
rbind(ms1, ms2)
pcr.ag
pcr.ag %>%
dplyr::select(V2,  mu1, se1, gt.name) %>%
mutate(pc = 1)->
ms1
names(ms1)[2:3] = c("mu", "s")
pcr.ag %>%
dplyr::select(V2,  mu2, se2, gt.name) %>%
mutate(pc = 2) ->
ms2
names(ms2)[2:3] = c("mu", "s")
rbind(ms1, ms2) %>%
ggplot(data=., aes(x=as.factor(gt.name), y=mu)) +
geom_errorbar(aes(x=as.factor(gt.name), ymin=mu-1.96*s, ymax=mu+1.96*s), width=.1) +
geom_point() +
theme_bw()  +
xlab(NULL) +
ylab("PCA Dimension 1\nProjection") +
facet_wrap(~pc, ncol = 1)
rbind(ms1, ms2) %>%
ggplot(data=., aes(x=as.factor(gt.name), y=mu)) +
geom_errorbar(aes(x=as.factor(gt.name), ymin=mu-1.96*s, ymax=mu+1.96*s), width=.1) +
geom_point() +
theme_bw()  +
xlab(NULL) +
ylab("PCA Dimension 1\nProjection") +
facet_wrap(~pc, ncol = 1) -> PanelE
ggplot(em.data, aes(x = f1.background, y = scaled.minute.trend, ymin = asymp.LCL, ymax = asymp.UCL, color = inversion.st)) +
geom_errorbar(width = 0.1, position=position_dodge(width = 0.5)) +
geom_point(position=position_dodge(width = 0.5)) +
#facet_grid(.~f1.background, scales = "free_y")+
theme_bw() +
#scale_color_manual(values = group.colors) +
facet_grid("model.slope" ~ . ) +
ylab("activity.slope")
ggplot(em.data, aes(x = f1.background, y = scaled.minute.trend, ymin = asymp.LCL, ymax = asymp.UCL, color = inversion.st)) +
geom_errorbar(width = 0.1, position=position_dodge(width = 0.5)) +
geom_point(position=position_dodge(width = 0.5)) +
#facet_grid(.~f1.background, scales = "free_y")+
theme_bw() +
#scale_color_manual(values = group.colors) +
facet_grid("model.slope" ~ . ) +
ylab("activity.slope") -> PanelF
phenotype.dt[knockout == "k2a"] %>%
group_by(inversion.st, f1.background,  knockout,# inversion.st
) %>%
summarise(mean = ci(sr.length)[1],
uci = ci(sr.length)[2],
lci = ci(sr.length)[3]
) %>%
ggplot(aes(
x=f1.background,
y=mean,
ymin=lci,
ymax=uci,
color =  inversion.st
)) +
# scale_color_manual(values = group.colors) +
geom_errorbar(width = 0.1, position=position_dodge(width = 0.5)) +
geom_point(position=position_dodge(width = 0.5)) +
facet_grid(knockout~., scales = "free_y")+
xlab("gene.deficiecy.status") +
ylab("startle.length") +
theme_bw()
phenotype.dt[knockout == "k2a"] %>%
group_by(inversion.st, f1.background,  knockout,# inversion.st
) %>%
summarise(mean = ci(sr.length)[1],
uci = ci(sr.length)[2],
lci = ci(sr.length)[3]
) %>%
ggplot(aes(
x=f1.background,
y=mean,
ymin=lci,
ymax=uci,
color =  inversion.st
)) +
# scale_color_manual(values = group.colors) +
geom_errorbar(width = 0.1, position=position_dodge(width = 0.5)) +
geom_point(position=position_dodge(width = 0.5)) +
facet_grid(knockout~., scales = "free_y")+
xlab("gene.deficiecy.status") +
ylab("startle.length") +
theme_bw()
library(gtools)
group_by(inversion.st, f1.background,  knockout,# inversion.st
) %>%
summarise(mean = ci(sr.length)[1],
uci = ci(sr.length)[2],
lci = ci(sr.length)[3]
) %>%
ggplot(aes(
x=f1.background,
y=mean,
ymin=lci,
ymax=uci,
color =  inversion.st
)) +
# scale_color_manual(values = group.colors) +
geom_errorbar(width = 0.1, position=position_dodge(width = 0.5)) +
geom_point(position=position_dodge(width = 0.5)) +
facet_grid(knockout~., scales = "free_y")+
xlab("gene.deficiecy.status") +
ylab("startle.length") +
theme_bw()
phenotype.dt[knockout == "k2a"] %>%
group_by(inversion.st, f1.background,  knockout,# inversion.st
) %>%
summarise(mean = ci(sr.length)[1],
uci = ci(sr.length)[2],
lci = ci(sr.length)[3]
) %>%
ggplot(aes(
x=f1.background,
y=mean,
ymin=lci,
ymax=uci,
color =  inversion.st
)) +
# scale_color_manual(values = group.colors) +
geom_errorbar(width = 0.1, position=position_dodge(width = 0.5)) +
geom_point(position=position_dodge(width = 0.5)) +
facet_grid(knockout~., scales = "free_y")+
xlab("gene.deficiecy.status") +
ylab("startle.length") +
theme_bw()
ci
library(gtools)
ci
??ci
library(gmodels)
phenotype.dt[knockout == "k2a"] %>%
group_by(inversion.st, f1.background,  knockout,# inversion.st
) %>%
summarise(mean = ci(sr.length)[1],
uci = ci(sr.length)[2],
lci = ci(sr.length)[3]
) %>%
ggplot(aes(
x=f1.background,
y=mean,
ymin=lci,
ymax=uci,
color =  inversion.st
)) +
# scale_color_manual(values = group.colors) +
geom_errorbar(width = 0.1, position=position_dodge(width = 0.5)) +
geom_point(position=position_dodge(width = 0.5)) +
facet_grid(knockout~., scales = "free_y")+
xlab("gene.deficiecy.status") +
ylab("startle.length") +
theme_bw()
phenotype.dt[knockout == "k2a"] %>%
group_by(inversion.st, f1.background,  knockout,# inversion.st
) %>%
summarise(mean = ci(sr.length)[1],
uci = ci(sr.length)[2],
lci = ci(sr.length)[3]
) %>%
ggplot(aes(
x=f1.background,
y=mean,
ymin=lci,
ymax=uci,
color =  inversion.st
)) +
# scale_color_manual(values = group.colors) +
geom_errorbar(width = 0.1, position=position_dodge(width = 0.5)) +
geom_point(position=position_dodge(width = 0.5)) +
facet_grid(knockout~., scales = "free_y")+
xlab("gene.deficiecy.status") +
ylab("startle.length") +
theme_bw() -> panelG
panelA
panelB
panelC
ggplot() +
#geom_rect(data=outlier_haplowins, aes(xmin=start/1e6, xmax=end/1e6, ymin=-1, ymax=100),fill ="lightgoldenrod1", alpha=.5) +
geom_rect(data = final.windows.pos,
aes(xmin=start/1e6, xmax = end/1e6,
ymin = 0, ymax = 40),
alpha = 0.7, fill = "gold") +
#geom_line(data = dt.window[perm.st == "permutation"],
#           aes(x=I(start/2+end/2)/1e6, y=avg.N), color="black") +
#geom_line(data = dt.window[perm.st == "permutation"],
#           aes(x=I(start/2+end/2)/1e6, y=lowerbound), color="black", linetype = "dashed") +
geom_vline(xintercept = 2225744/1e6) +
geom_vline(xintercept = 13154180/1e6) +
geom_ribbon(data = dt.window[perm.st == "permutation"],
aes(x=I(start/2+end/2)/1e6, ymax= upperbound, ymin = 0), fill="grey", linetype = "solid", alpha = 0.5) +
geom_point(data=dt.window[perm.st == "observed"],
aes(x=I(start/2+end/2)/1e6, y=avg.N, color = sig.v.per), #color="firebrick4",
size = 3.0) +
theme_bw()+
# ylim(0,25) +
xlab("Position on Chromosome") +
ylab( "# of Co-enriched Phenos") -> PanelC
panelC
ggplot() +
#geom_rect(data=outlier_haplowins, aes(xmin=start/1e6, xmax=end/1e6, ymin=-1, ymax=100),fill ="lightgoldenrod1", alpha=.5) +
geom_rect(data = final.windows.pos,
aes(xmin=start/1e6, xmax = end/1e6,
ymin = 0, ymax = 40),
alpha = 0.7, fill = "gold") +
#geom_line(data = dt.window[perm.st == "permutation"],
#           aes(x=I(start/2+end/2)/1e6, y=avg.N), color="black") +
#geom_line(data = dt.window[perm.st == "permutation"],
#           aes(x=I(start/2+end/2)/1e6, y=lowerbound), color="black", linetype = "dashed") +
geom_vline(xintercept = 2225744/1e6) +
geom_vline(xintercept = 13154180/1e6) +
geom_ribbon(data = dt.window[perm.st == "permutation"],
aes(x=I(start/2+end/2)/1e6, ymax= upperbound, ymin = 0), fill="grey", linetype = "solid", alpha = 0.5) +
geom_point(data=dt.window[perm.st == "observed"],
aes(x=I(start/2+end/2)/1e6, y=avg.N, color = sig.v.per), #color="firebrick4",
size = 3.0) +
theme_bw()+
# ylim(0,25) +
xlab("Position on Chromosome") +
ylab( "# of Co-enriched Phenos") -> panelC
panelC
panelF
ggplot(em.data, aes(x = f1.background, y = scaled.minute.trend, ymin = asymp.LCL, ymax = asymp.UCL, color = inversion.st)) +
geom_errorbar(width = 0.1, position=position_dodge(width = 0.5)) +
geom_point(position=position_dodge(width = 0.5)) +
#facet_grid(.~f1.background, scales = "free_y")+
theme_bw() +
#scale_color_manual(values = group.colors) +
facet_grid("model.slope" ~ . ) +
ylab("activity.slope") -> panelF
panelF
panelG
(panelA+panelB+panelC)/(panelD+panelE+(panelF/panelG))
panelA
panelB
panelC
panelD
panelD
rbind(ms1, ms2) %>%
ggplot(data=., aes(x=as.factor(gt.name), y=mu)) +
geom_errorbar(aes(x=as.factor(gt.name), ymin=mu-1.96*s, ymax=mu+1.96*s), width=.1) +
geom_point() +
theme_bw()  +
xlab(NULL) +
ylab("PCA Dimension 1\nProjection") +
facet_wrap(~pc, ncol = 1) -> panelE
rbind(ms1, ms2) %>%
ggplot(data=., aes(x=as.factor(gt.name), y=mu)) +
geom_errorbar(aes(x=as.factor(gt.name), ymin=mu-1.96*s, ymax=mu+1.96*s), width=.1) +
geom_point() +
theme_bw()  +
xlab(NULL) +
ylab("PCA Dimension 1\nProjection") +
facet_wrap(~pc, ncol = 1) -> panelD
ggplot(em.data, aes(x = f1.background, y = scaled.minute.trend, ymin = asymp.LCL, ymax = asymp.UCL, color = inversion.st)) +
geom_errorbar(width = 0.1, position=position_dodge(width = 0.5)) +
geom_point(position=position_dodge(width = 0.5)) +
#facet_grid(.~f1.background, scales = "free_y")+
theme_bw() +
#scale_color_manual(values = group.colors) +
facet_grid("model.slope" ~ . ) +
ylab("activity.slope") -> panelE
phenotype.dt[knockout == "k2a"] %>%
group_by(inversion.st, f1.background,  knockout,# inversion.st
) %>%
summarise(mean = ci(sr.length)[1],
uci = ci(sr.length)[2],
lci = ci(sr.length)[3]
) %>%
ggplot(aes(
x=f1.background,
y=mean,
ymin=lci,
ymax=uci,
color =  inversion.st
)) +
# scale_color_manual(values = group.colors) +
geom_errorbar(width = 0.1, position=position_dodge(width = 0.5)) +
geom_point(position=position_dodge(width = 0.5)) +
facet_grid(knockout~., scales = "free_y")+
xlab("gene.deficiecy.status") +
ylab("startle.length") +
theme_bw() -> panelF
(panelA+panelB+panelC)
panelD
panelE
lim <- 1.8
ggplot(data=pc_loading) +
coord_equal() +
geom_segment(aes(x=0, y=0, xend=Dim.1, yend=Dim.2), arrow=arrow(length=unit(0.2,"cm"))) +
geom_text(data=pc_loading[Dim.1<0], aes(x=x, y=y, label=pheno), size = 2.75, vjust=1, hjust=1) +
geom_text(data=pc_loading[Dim.1>0], aes(x=x, y=y, label=pheno), size = 2.75, vjust=1, hjust=0) +
geom_segment(aes(x=x, y=y, xend=Dim.1, yend=Dim.2), color="grey", alpha=0.5) +
xlim(-lim,lim) + ylim(-lim,lim) +
theme_bw() + xlab("PCA Dimension 1 Loadings (12.5%)") + ylab("PCA Dimension 2 Loadings (7.8%)") -> PanelD
ggplot(data=pc_loading) +
coord_equal() +
geom_segment(aes(x=0, y=0, xend=Dim.1, yend=Dim.2), arrow=arrow(length=unit(0.2,"cm"))) +
geom_text(data=pc_loading[Dim.1<0], aes(x=x, y=y, label=pheno), size = 2.75, vjust=1, hjust=1) +
geom_text(data=pc_loading[Dim.1>0], aes(x=x, y=y, label=pheno), size = 2.75, vjust=1, hjust=0) +
geom_segment(aes(x=x, y=y, xend=Dim.1, yend=Dim.2), color="grey", alpha=0.5) +
xlim(-lim,lim) + ylim(-lim,lim) +
theme_bw() + xlab("PCA Dimension 1 Loadings (12.5%)") + ylab("PCA Dimension 2 Loadings (7.8%)") -> panelD
rbind(ms1, ms2) %>%
ggplot(data=., aes(x=as.factor(gt.name), y=mu)) +
geom_errorbar(aes(x=as.factor(gt.name), ymin=mu-1.96*s, ymax=mu+1.96*s), width=.1) +
geom_point() +
theme_bw()  +
xlab(NULL) +
ylab("PCA Dimension 1\nProjection") +
facet_wrap(~pc, ncol = 1) -> panelE
ggplot(em.data, aes(x = f1.background, y = scaled.minute.trend, ymin = asymp.LCL, ymax = asymp.UCL, color = inversion.st)) +
geom_errorbar(width = 0.1, position=position_dodge(width = 0.5)) +
geom_point(position=position_dodge(width = 0.5)) +
#facet_grid(.~f1.background, scales = "free_y")+
theme_bw() +
#scale_color_manual(values = group.colors) +
facet_grid("model.slope" ~ . ) +
ylab("activity.slope") -> panelF
phenotype.dt[knockout == "k2a"] %>%
group_by(inversion.st, f1.background,  knockout,# inversion.st
) %>%
summarise(mean = ci(sr.length)[1],
uci = ci(sr.length)[2],
lci = ci(sr.length)[3]
) %>%
ggplot(aes(
x=f1.background,
y=mean,
ymin=lci,
ymax=uci,
color =  inversion.st
)) +
# scale_color_manual(values = group.colors) +
geom_errorbar(width = 0.1, position=position_dodge(width = 0.5)) +
geom_point(position=position_dodge(width = 0.5)) +
facet_grid(knockout~., scales = "free_y")+
xlab("gene.deficiecy.status") +
ylab("startle.length") +
theme_bw() -> panelG
(panelD+panelE+(panelF/panelG))
joint <- /(panelD+panelE+(panelF/panelG))
joint.fig = (panelA+panelB+panelC)/(panelD+panelE+(panelF/panelG))
gtotal = (g1/ g2 / g3) | g4
ggsave(joint.fig, file =  "fig.d6.png", width = 14, height = 7)
###make patchwork figures
ggsave(joint.fig, file =  "fig.d6.pdf", width = 14, height = 7)
label=c("k2a","k5a","k5b","k9a","k22")
label
data.frame(
label=c("k2a","k5a","k5b","k9a","k2b"),
start=c(2450829,505636,5073453,8958155,2242285),
end=c(2450829,5305636,5145500,9581740,2374023)
)
data.frame(
label=c("k2a","k5a","k5b","k9a","k2b"),
start=c(2450829,505636,5073453,8958155,2242285),
end=c(2450829,5305636,5145500,9581740,2374023),
yaxis=1:5
) %>%
ggplot(aes(
xmin=start,
xmax=end,
ymin=yaxis,
ymax=yaxis,
color=label
)) +
geom_rect()
data.frame(
label=c("k2a","k5a","k5b","k9a","k2b"),
start=c(2175620,2242285,505636,5073453,8958155),
end=c(2450829,2374023,5305636,5145500,9581740),
yaxis=1:5
) %>%
ggplot(aes(
xmin=start,
xmax=end,
ymin=yaxis,
ymax=yaxis,
color=label
)) +
geom_rect()
data.frame(
label=c("k2a","k5a","k5b","k9a","k2b"),
start=c(2175620,2242285,5147258,5073453,8958155),
end=c(2450829,2374023,5305636,5145500,9581740),
yaxis=1:5
) %>%
ggplot(aes(
xmin=start,
xmax=end,
ymin=yaxis,
ymax=yaxis,
color=label
)) +
geom_rect()
data.frame(
label=c("k2a","k5a","k5b","k9a","k2b"),
start=c(2175620,2242285,5147258,5073453,8958155),
end=c(2450829,2374023,5305636,5145500,9581740),
yaxis=1:5
) %>%
ggplot(aes(
xmin=start,
xmax=end,
ymin=yaxis-0.5,
ymax=yaxis+0.5,
color=label
)) +
geom_rect() +
ylim(0,20e6)
data.frame(
label=c("k2a","k5a","k5b","k9a","k2b"),
start=c(2175620,2242285,5147258,5073453,8958155),
end=c(2450829,2374023,5305636,5145500,9581740),
yaxis=1:5
) %>%
ggplot(aes(
xmin=start,
xmax=end,
ymin=yaxis-0.5,
ymax=yaxis+0.5,
color=label
)) +
geom_rect() +
xlim(0,20e6)
data.frame(
label=c("k2a","k5a","k5b","k9a","k2b"),
start=c(2175620,2242285,5147258,5073453,8958155),
end=c(2450829,2374023,5305636,5145500,9581740),
yaxis=1:5
) %>%
ggplot(aes(
xmin=start,
xmax=end,
ymin=yaxis-0.05,
ymax=yaxis+0.05,
color=label
)) +
geom_rect() +
xlim(0,20e6)
data.frame(
label=c("k2a","k2b", "k5a","k5b","k9a"),
start=c(2175620,2242285,5147258,5073453,8958155),
end=c(2450829,2374023,5305636,5145500,9581740),
yaxis=1:5
) %>%
ggplot(aes(
xmin=start,
xmax=end,
ymin=yaxis-0.05,
ymax=yaxis+0.05,
color=label
)) +
geom_rect() +
xlim(0,20e6)
data.frame(
label=c("k2a","k2b", "k5a","k5b","k9a"),
start=c(2175620,2242285,5147258,5073453,8958155),
end=c(2450829,2374023,5305636,5145500,9581740),
yaxis=1:5
) %>%
ggplot(aes(
xmin=start,
xmax=end,
ymin=yaxis-0.05,
ymax=yaxis+0.05,
fill=label
)) +
geom_rect() +
xlim(0,20e6)
pcr.ag
ls()
load("figuredataOctober.Rdata")
ls()
pc_loading
ls()
phenotype.dt"
q
phenotype.dt
ls()
em.data
observedata
observedata
pc_loading
phenotype.dt[knockout == "k2a"]
phenotype.dt[knockout == "k2a"]
final.windows.pos
dt.window[perm.st == "observed"]
dt.window[perm.st == "observed"] %>% sort(upperbound)
dt.window[perm.st == "observed"] %>% arrange(upperbound)
dt.window[perm.st == "observed"] %>% arrange(-upperbound)
