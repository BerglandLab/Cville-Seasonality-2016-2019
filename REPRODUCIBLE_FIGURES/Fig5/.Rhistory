geom_vline(xintercept = 7710690)
D.inv <- read.delim("~/Downloads/D.CM.W_100000.S_50000.INV.Tajima.D")
D.inv %>%
filter(CHROM == "2L") %>%
ggplot(aes(
x=BIN_START,
y=TajimaD
)) +
geom_vline(xintercept = 7702805, color = "red") +
geom_line(size = 1.2) +
q
D.inv %>%
filter(CHROM == "2L") %>%
ggplot(aes(
x=BIN_START,
y=TajimaD)) +
geom_vline(xintercept = 7702805, color = "red") +
geom_line(size = 1.2)
D.inv %>%
filter(CHROM == "2L") %>%
ggplot(aes(
x=BIN_START,
y=TajimaD)) +
geom_vline(xintercept = 7702805, color = "red") +
geom_hline(yintercept = 0) +
geom_hline(yintercept = 1, lintype = "dashed") +
geom_hline(yintercept = -1, lintype = "dashed") +
geom_line(size = 1.2)
D.inv %>%
filter(CHROM == "2L") %>%
ggplot(aes(
x=BIN_START,
y=TajimaD)) +
geom_vline(xintercept = 7702805, color = "red") +
geom_hline(yintercept = 0) +
geom_hline(yintercept = 1, linetype = "dashed") +
geom_hline(yintercept = -1, linetype = "dashed") +
theme_bw() +
geom_line(size = 1.2)
D.std <- read.delim("~/Downloads/D.CM.W_100000.S_50000.STD.Tajima.D")
D.std %>%
filter(CHROM == "2L") %>%
ggplot(aes(
x=BIN_START,
y=TajimaD)) +
geom_vline(xintercept = 7702805, color = "red") +
geom_hline(yintercept = 0) +
geom_hline(yintercept = 1, linetype = "dashed") +
geom_hline(yintercept = -1, linetype = "dashed") +
theme_bw() +
geom_line(size = 1.2)
D.std %>%
filter(CHROM == "2L") %>%
ggplot(aes(
x=BIN_START,
y=TajimaD)) +
geom_vline(xintercept = 7702805, color = "red") +
geom_hline(yintercept = 0) +
geom_hline(yintercept = 1, linetype = "dashed") +
geom_hline(yintercept = -1, linetype = "dashed") +
theme_bw() +
geom_line(size = 1.2, color = "grey")
D.inv
D.inv <- read.delim("~/Downloads/D.CM.W_100000.S_50000.INV.Tajima.D")
D.std <- read.delim("~/Downloads/D.CM.W_100000.S_50000.STD.Tajima.D")
library(tidyverse)
library(magrittr)
D.inv <- read.delim("~/Downloads/D.CM.W_100000.S_50000.INV.Tajima.D")
D.inv %<>% mutate(set = "inv")
D.std <- read.delim("~/Downloads/D.CM.W_100000.S_50000.STD.Tajima.D")
D.std %<>% mutate(set = "std")
rbind(D.inv, D.std) %>%
filter(CHROM == "2L") %>%
ggplot(aes(
x=BIN_START,
y=TajimaD,
color = set)) +
geom_vline(xintercept = 7702805, color = "red") +
geom_hline(yintercept = 0) +
geom_hline(yintercept = 1, linetype = "dashed") +
geom_hline(yintercept = -1, linetype = "dashed") +
theme_bw() +
geom_line(size = 1.1)
rbind(D.inv, D.std) %>%
filter(CHROM == "2L") %>%
ggplot(aes(
x=BIN_START,
y=TajimaD,
color = set)) +
geom_vline(xintercept = 7702805, color = "purple") +
geom_hline(yintercept = 0) +
geom_hline(yintercept = 1, linetype = "dashed") +
geom_hline(yintercept = -1, linetype = "dashed") +
theme_bw() +
geom_line(size = 1.1)
rbind(D.inv, D.std) %>%
filter(CHROM == "2L") %>%
ggplot(aes(
x=BIN_START,
y=TajimaD,
color = set)) +
geom_vline(xintercept = 7702805, color = "purple") +
geom_vline(xintercept = 2225744) +
geom_vline(xintercept = 13154180) +
geom_hline(yintercept = 0) +
geom_hline(yintercept = 1, linetype = "dashed") +
geom_hline(yintercept = -1, linetype = "dashed") +
theme_bw() +
geom_line(size = 1.1)
rbind(D.inv, D.std) %>%
filter(CHROM == "#L") %>%
ggplot(aes(
x=BIN_START,
y=TajimaD,
color = set)) +
geom_vline(xintercept = 3336032, color = "purple") +
geom_hline(yintercept = 0) +
geom_hline(yintercept = 1, linetype = "dashed") +
geom_hline(yintercept = -1, linetype = "dashed") +
theme_bw() +
geom_line(size = 1.1)
rbind(D.inv, D.std) %>%
filter(CHROM == "3L") %>%
ggplot(aes(
x=BIN_START,
y=TajimaD,
color = set)) +
geom_vline(xintercept = 3336032, color = "purple") +
geom_hline(yintercept = 0) +
geom_hline(yintercept = 1, linetype = "dashed") +
geom_hline(yintercept = -1, linetype = "dashed") +
theme_bw() +
geom_line(size = 1.1)
rbind(D.inv, D.std) %>%
filter(CHROM == "2L") %>%
ggplot(aes(
x=BIN_START,
y=TajimaD,
color = set)) +
geom_vline(xintercept = 7702805, color = "purple") +
geom_vline(xintercept = 2225744) +
geom_vline(xintercept = 13154180) +
geom_hline(yintercept = 0) +
geom_hline(yintercept = 1, linetype = "dashed") +
geom_hline(yintercept = -1, linetype = "dashed") +
theme_bw() +
xlim(7e6,8e6) +
geom_line(size = 1.1)
library(tidyverse)
library(magrittr)
library(data.table)
library(foreach)
root <- paste(base, paste("data3", metric, sep = "."), sep = "/")
root <- paste(base, paste("data3", metric, sep = "."), sep = "/")
library(data.table)
library(tidyverse)
library(magrittr)
library(reshape2)
library(foreach)
## load
choice.dat <- fread("/Users/jcbnunez/Downloads/Final_Project_Fly_Count.tsv")
library(tidyverse)
a = c( rep(6970, 13), rep(317, 2) )
1/mean(1/a)
a = c( rep(25000, 13), rep(2500, 2) )
1/mean(1/a)
a = c( rep(25000, 13), rep(1500, 2) )
1/mean(1/a)
rm(list = ls())
library(tidyverse)
library(magrittr)
library(factoextra)
library(FactoMineR)
library(gtools)
library(patchwork)
library(ggalt)
slice_n
?slice_n
?slice_
slice_
library(vcfR)
library(adegenet)
library(tidyverse)
library(vroom)
slice_mutation_of_interst.stus %>%
filter(loci %in% c(0,2)) %>%
group_by(loci) %>%
slice_head(n=9)
glm.snps$SNP_id[i]
0.05/3
0.05/5
pw <-dcast(pl[pos==5192177][variable%in%target$pheno], ral_id+gt~variable, value.var="x_norm")
20*4
5*4
library(vroom)
fst <- vroom("/Users/jcbnunez/Downloads/FST.W_10000.S_5000.DPGP3.windowed.weir.fst")
fst
fst %>% tail
library(tidyverse)
fst %>% tail
fst
fst %>% ggplot(aes(x = BIN_START, y = WEIGHTED_FST))  +geom_line()
vroom
vcf.r = vroom("/project/berglandlab/jcbnunez/emergency_scratch/dpgp3/vcfs_o/ZI104_Chr2L.seq.named.fasta.vcf")
?vroom
vcf.r = vroom("/project/berglandlab/jcbnunez/emergency_scratch/dpgp3/vcfs_o/ZI104_Chr2L.seq.named.fasta.vcf", delim = "\t", comment = "##")
vcf.r %>%
mutate(samp.tmp = case_when(ALT == "N" ~ "./.",
ALT == REF ~ "0/0",
REF != ALT ~ "1/1",
)) ->
vcf.r.fix
file.o=as.character(args[1])
fst <- vroom("/Users/jcbnunez/Downloads/FST.W_500000.S_100000.DPGP3.windowed.weir.fst")
fst
fst %>%
ggplot(
aes(
x= c(BIN_START+BIN_END)/2
y=WEIGHTED_FST
fst %>%
ggplot(
aes(
x= c(BIN_START+BIN_END)/2,
y= WEIGHTED_FST
)
) +  geom_line()
fst <- vroom("/Users/jcbnunez/Downloads/FST.W_10000.S_5000.DPGP3.windowed.weir.fst")
fst %>%
ggplot(
aes(
x= c(BIN_START+BIN_END)/2,
y= WEIGHTED_FST
)
) +  geom_line()
fst <- vroom("/Users/jcbnunez/Downloads/FST.W_100000.S_50000.DPGP3.windowed.weir.fst")
fst %>%
ggplot(
aes(
x= c(BIN_START+BIN_END)/2,
y= WEIGHTED_FST
)
) +  geom_line()
fst
fst %>%
ggplot(
aes(
x= c(BIN_START+BIN_END)/2,
y= MEAN_FST
)
) +  geom_line()
fst %>%
ggplot(
aes(
x= c(BIN_START+BIN_END)/2,
y= WEIGHTED_FST
)
) +  geom_line()
fst %>%
ggplot(
aes(
x= c(BIN_START+BIN_END)/2/1e6,
y= WEIGHTED_FST
)
) +  geom_line() +
geom_vline(xintercept = 2225744/1e6) +
geom_vline(xintercept = 13154180/1e6)
fst %>%
ggplot(
aes(
x= c(BIN_START+BIN_END)/2/1e6,
y= WEIGHTED_FST
)
) +
geom_vline(xintercept = 2225744/1e6, color = "red") +
geom_vline(xintercept = 13154180/1e6, color = "red") +
geom_line()
5192177
5192177+10000
5192177-10000
vcftools \
data.frame(
line.Line= row.names(x.dpgp.tab),
tsp=x.dpgp.tab[,"5192177_SNP"]) -> tsp.dat.dpgp
library(data.table)
setwd("/Users/jcbnunez/Documents/GitHub/Cville-Seasonality-2016-2019/REPRODUCIBLE_FIGURES/Fig5")
ls -l
ls()
##
library(tidyverse)
library(magrittr)
library(data.table)
library(gmodels)
### For Panel A
load("./out_count.Rdata")
### For pannel B
load("./co.enrich.files.Rdata")
## For panel C
dt.window =  get(load("./sliding.windowholm.Rdata"))
pheno <- readRDS("./wideform.fixed.phenotable.RDS")
### For panel D and E
pc_loading = readRDS("pca_pheno.data")
pcr.ag = readRDS("pca_loadings.data")
pca.info = load("pc.object.Rdata")
#### For Panels F/G
load(file = "deficiency.line.Rdata")
load(file = "phenotype.dt.Rdata")
##
library(tidyverse)
library(magrittr)
library(data.table)
library(gmodels)
### For Panel A
load("./out_count.Rdata")
### For pannel B
load("./co.enrich.files.Rdata")
## For panel C
dt.window =  get(load("./sliding.windowholm.Rdata"))
pheno <- readRDS("./wideform.fixed.phenotable.RDS")
### For panel D and E
pc_loading = readRDS("pca_pheno.data")
pcr.ag = readRDS("pca_loadings.data")
pca.info = load("pc.object.Rdata")
#### For Panels F/G
load(file = "deficiency.line.Rdata")
load(file = "phenotype.dt.Rdata")
dt.window
dt.window
final.windows.pos =
data.frame(win.name = c("win_3.1", "win_4.7", "win_5.1", "win_6.1", "win_6.8", "win_9.6" ),
mid = c(3.0, 4.67, 5.15, 6.2, 6.8 , 9.6)
) %>%
mutate(start = (mid-0.2)*1e6 ,
end  = (mid+0.2)*1e6,
chr = "2L")
ggplot() +
#geom_rect(data=outlier_haplowins, aes(xmin=start/1e6, xmax=end/1e6, ymin=-1, ymax=100),fill ="lightgoldenrod1", alpha=.5) +
geom_rect(data = final.windows.pos,
aes(xmin=start/1e6, xmax = end/1e6,
ymin = 0, ymax = 40),
alpha = 0.7, fill = "gold") +
#geom_line(data = dt.window[perm.st == "permutation"],
#           aes(x=I(start/2+end/2)/1e6, y=avg.N), color="black") +
#geom_line(data = dt.window[perm.st == "permutation"],
#           aes(x=I(start/2+end/2)/1e6, y=lowerbound), color="black", linetype = "dashed") +
geom_vline(xintercept = 2225744/1e6) +
geom_vline(xintercept = 13154180/1e6) +
geom_ribbon(data = dt.window[perm.st == "permutation"][chr == "2L"],
aes(x=I(start/2+end/2)/1e6, ymax= upperbound, ymin = 0), fill="grey", linetype = "solid", alpha = 0.5) +
geom_point(data=dt.window[perm.st == "observed"][chr == "2L"],
aes(x=I(start/2+end/2)/1e6, y=avg.N, color = sig.v.per), #color="firebrick4",
size = 2) +
theme_bw()+
theme(legend.position = "none") +
# ylim(0,25) +
xlab("Position on Chromosome") +
ylab( "# of Co-enriched Phenos") -> PanelC
ggsave(PanelC, file =  "./new.model2.5.fdr.pdf", w = 7, h = 3)
final.windows.pos =
data.frame(win.name = c("win_3.1", "win_4.7", "win_5.1", "win_6.1", "win_6.8", "win_9.6" ),
mid = c(3.0, 4.67, 5.15, 6.2, 6.8 , 9.6)
) %>%
mutate(start = (mid-0.2)*1e6 ,
end  = (mid+0.2)*1e6,
chr = "2L")
ggplot() +
#geom_rect(data=outlier_haplowins, aes(xmin=start/1e6, xmax=end/1e6, ymin=-1, ymax=100),fill ="lightgoldenrod1", alpha=.5) +
geom_rect(data = final.windows.pos,
aes(xmin=start/1e6, xmax = end/1e6,
ymin = 0, ymax = 40),
alpha = 0.7, fill = "gold") +
#geom_line(data = dt.window[perm.st == "permutation"],
#           aes(x=I(start/2+end/2)/1e6, y=avg.N), color="black") +
#geom_line(data = dt.window[perm.st == "permutation"],
#           aes(x=I(start/2+end/2)/1e6, y=lowerbound), color="black", linetype = "dashed") +
geom_vline(xintercept = 2225744/1e6) +
geom_vline(xintercept = 13154180/1e6) +
geom_ribbon(data = dt.window[perm.st == "permutation"],
aes(x=I(start/2+end/2)/1e6, ymax= upperbound, ymin = 0), fill="grey", linetype = "solid", alpha = 0.5) +
geom_point(data=dt.window[perm.st == "observed"],
aes(x=I(start/2+end/2)/1e6, y=avg.N, color = sig.v.per), #color="firebrick4",
size = 2) +
theme_bw()+
facet_grid(~chr, scales = "free_x")
theme(legend.position = "none") +
# ylim(0,25) +
xlab("Position on Chromosome") +
ylab( "# of Co-enriched Phenos")
library(vroom)
inv.tb <- vroom("InversionsMap_hglft_v6_inv_startStop.txt")
inv.tb
ggplot() +
#geom_rect(data=outlier_haplowins, aes(xmin=start/1e6, xmax=end/1e6, ymin=-1, ymax=100),fill ="lightgoldenrod1", alpha=.5) +
geom_rect(data = inv.tb,
aes(xmin=start/1e6, xmax = end/1e6,
ymin = 0, ymax = 35),
alpha = 0.7, fill = "grey") +
#geom_line(data = dt.window[perm.st == "permutation"],
#           aes(x=I(start/2+end/2)/1e6, y=avg.N), color="black") +
#geom_line(data = dt.window[perm.st == "permutation"],
#           aes(x=I(start/2+end/2)/1e6, y=lowerbound), color="black", linetype = "dashed") +
#geom_vline(xintercept = 2225744/1e6) +
#geom_vline(xintercept = 13154180/1e6) +
geom_ribbon(data = dt.window[perm.st == "permutation"],
aes(x=I(start/2+end/2)/1e6, ymax= upperbound, ymin = 0), fill="grey", linetype = "solid", alpha = 0.5) +
geom_point(data=dt.window[perm.st == "observed"],
aes(x=I(start/2+end/2)/1e6, y=avg.N, color = sig.v.per), #color="firebrick4",
size = 2) +
theme_bw()+
facet_grid(~chr, scales = "free_x")
ggplot() +
#geom_rect(data=outlier_haplowins, aes(xmin=start/1e6, xmax=end/1e6, ymin=-1, ymax=100),fill ="lightgoldenrod1", alpha=.5) +
geom_rect(data = inv.tb,
aes(xmin=start/1e6, xmax = end/1e6,
ymin = 0, ymax = 35),
alpha = 0.7, fill = "grey") +
#geom_line(data = dt.window[perm.st == "permutation"],
#           aes(x=I(start/2+end/2)/1e6, y=avg.N), color="black") +
#geom_line(data = dt.window[perm.st == "permutation"],
#           aes(x=I(start/2+end/2)/1e6, y=lowerbound), color="black", linetype = "dashed") +
#geom_vline(xintercept = 2225744/1e6) +
#geom_vline(xintercept = 13154180/1e6) +
geom_ribbon(data = dt.window[perm.st == "permutation"],
aes(x=I(start/2+end/2)/1e6, ymax= upperbound, ymin = 0), fill="grey", linetype = "solid", alpha = 0.5) +
geom_point(data=dt.window[perm.st == "observed"],
aes(x=I(start/2+end/2)/1e6, y=avg.N, color = sig.v.per), #color="firebrick4",
size = 2) +
theme_bw()+
facet_grid(~chr, scales = "free_x")
inv.tb
ggplot() +
#geom_rect(data=outlier_haplowins, aes(xmin=start/1e6, xmax=end/1e6, ymin=-1, ymax=100),fill ="lightgoldenrod1", alpha=.5) +
geom_rect(data = inv.tb,
aes(xmin=start/1e6, xmax = stop/1e6,
ymin = 0, ymax = 35),
alpha = 0.7, fill = "grey") +
#geom_line(data = dt.window[perm.st == "permutation"],
#           aes(x=I(start/2+end/2)/1e6, y=avg.N), color="black") +
#geom_line(data = dt.window[perm.st == "permutation"],
#           aes(x=I(start/2+end/2)/1e6, y=lowerbound), color="black", linetype = "dashed") +
#geom_vline(xintercept = 2225744/1e6) +
#geom_vline(xintercept = 13154180/1e6) +
geom_ribbon(data = dt.window[perm.st == "permutation"],
aes(x=I(start/2+end/2)/1e6, ymax= upperbound, ymin = 0), fill="grey", linetype = "solid", alpha = 0.5) +
geom_point(data=dt.window[perm.st == "observed"],
aes(x=I(start/2+end/2)/1e6, y=avg.N, color = sig.v.per), #color="firebrick4",
size = 2) +
theme_bw()+
facet_grid(~chr, scales = "free_x")
inv.tb
inv.tb <- vroom("InversionsMap_hglft_v6_inv_startStop.txt")
names(inv.tb)[1] = "chr"
ggplot() +
#geom_rect(data=outlier_haplowins, aes(xmin=start/1e6, xmax=end/1e6, ymin=-1, ymax=100),fill ="lightgoldenrod1", alpha=.5) +
geom_rect(data = inv.tb,
aes(xmin=start/1e6, xmax = stop/1e6,
ymin = 0, ymax = 35),
alpha = 0.7, fill = "grey") +
#geom_line(data = dt.window[perm.st == "permutation"],
#           aes(x=I(start/2+end/2)/1e6, y=avg.N), color="black") +
#geom_line(data = dt.window[perm.st == "permutation"],
#           aes(x=I(start/2+end/2)/1e6, y=lowerbound), color="black", linetype = "dashed") +
#geom_vline(xintercept = 2225744/1e6) +
#geom_vline(xintercept = 13154180/1e6) +
geom_ribbon(data = dt.window[perm.st == "permutation"],
aes(x=I(start/2+end/2)/1e6, ymax= upperbound, ymin = 0), fill="grey", linetype = "solid", alpha = 0.5) +
geom_point(data=dt.window[perm.st == "observed"],
aes(x=I(start/2+end/2)/1e6, y=avg.N, color = sig.v.per), #color="firebrick4",
size = 2) +
theme_bw()+
facet_grid(~chr, scales = "free_x")
inv.tb
ggplot() +
#geom_rect(data=outlier_haplowins, aes(xmin=start/1e6, xmax=end/1e6, ymin=-1, ymax=100),fill ="lightgoldenrod1", alpha=.5) +
geom_rect(data = inv.tb,
aes(xmin=start/1e6, xmax = stop/1e6,
ymin = 0, ymax = 35, fill = invName),
alpha = 0.7) +
#geom_line(data = dt.window[perm.st == "permutation"],
#           aes(x=I(start/2+end/2)/1e6, y=avg.N), color="black") +
#geom_line(data = dt.window[perm.st == "permutation"],
#           aes(x=I(start/2+end/2)/1e6, y=lowerbound), color="black", linetype = "dashed") +
#geom_vline(xintercept = 2225744/1e6) +
#geom_vline(xintercept = 13154180/1e6) +
geom_ribbon(data = dt.window[perm.st == "permutation"],
aes(x=I(start/2+end/2)/1e6, ymax= upperbound, ymin = 0), fill="grey", linetype = "solid", alpha = 0.5) +
geom_point(data=dt.window[perm.st == "observed"],
aes(x=I(start/2+end/2)/1e6, y=avg.N, color = sig.v.per), #color="firebrick4",
size = 2) +
theme_bw()+
facet_grid(~chr, scales = "free_x")
ggplot() +
#geom_rect(data=outlier_haplowins, aes(xmin=start/1e6, xmax=end/1e6, ymin=-1, ymax=100),fill ="lightgoldenrod1", alpha=.5) +
geom_rect(data = inv.tb,
aes(xmin=start/1e6, xmax = stop/1e6,
ymin = 0, ymax = 35, fill = invName),
alpha = 0.7) +
#geom_line(data = dt.window[perm.st == "permutation"],
#           aes(x=I(start/2+end/2)/1e6, y=avg.N), color="black") +
#geom_line(data = dt.window[perm.st == "permutation"],
#           aes(x=I(start/2+end/2)/1e6, y=lowerbound), color="black", linetype = "dashed") +
#geom_vline(xintercept = 2225744/1e6) +
#geom_vline(xintercept = 13154180/1e6) +
geom_ribbon(data = dt.window[perm.st == "permutation"],
aes(x=I(start/2+end/2)/1e6, ymax= upperbound, ymin = 0), fill="grey", linetype = "solid", alpha = 0.5) +
geom_point(data=dt.window[perm.st == "observed"],
aes(x=I(start/2+end/2)/1e6, y=avg.N, color = sig.v.per), #color="firebrick4",
size = 2) +
theme_bw()+
xlab("Genome Position (Mb)") +
ylab("Phenotypes (N)") +
facet_grid(~chr, scales = "free_x")
