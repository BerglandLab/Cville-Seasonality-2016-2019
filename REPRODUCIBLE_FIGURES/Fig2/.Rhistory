) + geom_line() +
geom_vline(xintercept = 15391154/10^6) +
geom_vline(xintercept = 20276334/10^6)
fst = vroom("/Users/jcbnunez/Downloads/NS_FST.noOtherINVS.windowed.weir.fst")
fst %>%
ggplot(
aes(
x=(BIN_START+BIN_END)/(2*10^6),
y=WEIGHTED_FST
)
) + geom_line() +
geom_vline(xintercept = 15391154/10^6) +
geom_vline(xintercept = 20276334/10^6)
fst = vroom("/Users/jcbnunez/Downloads/NS_FST.noOtherINVS.windowed.weir.fst")
fst %>%
ggplot(
aes(
x=(BIN_START+BIN_END)/(2*10^6),
y=WEIGHTED_FST
)
) + geom_line() +
geom_vline(xintercept = 15391154/10^6) +
geom_vline(xintercept = 20276334/10^6)
library(vroom)
library(tidyverse)
fst = vroom("/Users/jcbnunez/Downloads/NS_FST.noOtherINVS.windowed.weir.fst")
fst %>%
ggplot(
aes(
x=(BIN_START+BIN_END)/(2*10^6),
y=WEIGHTED_FST
)
) + geom_line() +
geom_vline(xintercept = 15391154/10^6) +
geom_vline(xintercept = 20276334/10^6)
seasonal.sets <- get(load("DEST2.seasonals.plusCore20.flip.met.Rdata"))
debugSource("~/Documents/GitHub/DESTv2_data_paper/11.Seasonality_Analysis/1.Seasonality_Analysis.R")
debugSource("~/Documents/GitHub/DESTv2_data_paper/11.Seasonality_Analysis/1.Seasonality_Analysis.R")
debugSource("~/Documents/GitHub/DESTv2_data_paper/11.Seasonality_Analysis/1.Seasonality_Analysis.R")
debugSource("~/Documents/GitHub/DESTv2_data_paper/11.Seasonality_Analysis/1.Seasonality_Analysis.R")
length(AF.tmp)
debugSource("~/Documents/GitHub/DESTv2_data_paper/11.Seasonality_Analysis/1.Seasonality_Analysis.R")
debugSource("~/Documents/GitHub/DESTv2_data_paper/11.Seasonality_Analysis/1.Seasonality_Analysis.R")
debugSource("~/Documents/GitHub/DESTv2_data_paper/11.Seasonality_Analysis/1.Seasonality_Analysis.R")
debugSource("~/Documents/GitHub/DESTv2_data_paper/11.Seasonality_Analysis/1.Seasonality_Analysis.R")
debugSource("~/Documents/GitHub/DESTv2_data_paper/11.Seasonality_Analysis/1.Seasonality_Analysis.R")
debugSource("~/Documents/GitHub/DESTv2_data_paper/11.Seasonality_Analysis/1.Seasonality_Analysis.R")
data.frame(
sampleId = set.samps,
AF = AF.tmp,
DP = DP.tmp
)
debugSource("~/Documents/GitHub/DESTv2_data_paper/11.Seasonality_Analysis/1.Seasonality_Analysis.R")
debugSource("~/Documents/GitHub/DESTv2_data_paper/11.Seasonality_Analysis/1.Seasonality_Analysis.R")
debugSource("~/Documents/GitHub/DESTv2_data_paper/11.Seasonality_Analysis/1.Seasonality_Analysis.R")
debugSource("~/Documents/GitHub/DESTv2_data_paper/11.Seasonality_Analysis/1.Seasonality_Analysis.R")
debugSource("~/Documents/GitHub/DESTv2_data_paper/11.Seasonality_Analysis/1.Seasonality_Analysis.R")
debugSource("~/Documents/GitHub/DESTv2_data_paper/11.Seasonality_Analysis/1.Seasonality_Analysis.R")
debugSource("~/Documents/GitHub/DESTv2_data_paper/11.Seasonality_Analysis/1.Seasonality_Analysis.R")
debugSource("~/Documents/GitHub/DESTv2_data_paper/11.Seasonality_Analysis/1.Seasonality_Analysis.R")
debugSource("~/Documents/GitHub/DESTv2_data_paper/11.Seasonality_Analysis/1.Seasonality_Analysis.R")
debugSource("~/Documents/GitHub/DESTv2_data_paper/11.Seasonality_Analysis/1.Seasonality_Analysis.R")
debugSource("~/Documents/GitHub/DESTv2_data_paper/11.Seasonality_Analysis/1.Seasonality_Analysis.R")
debugSource("~/Documents/GitHub/DESTv2_data_paper/11.Seasonality_Analysis/1.Seasonality_Analysis.R")
debugSource("~/Documents/GitHub/DESTv2_data_paper/11.Seasonality_Analysis/1.Seasonality_Analysis.R")
debugSource("~/Documents/GitHub/DESTv2_data_paper/11.Seasonality_Analysis/1.Seasonality_Analysis.R")
debugSource("~/Documents/GitHub/DESTv2_data_paper/11.Seasonality_Analysis/1.Seasonality_Analysis.R")
debugSource("~/Documents/GitHub/DESTv2_data_paper/11.Seasonality_Analysis/1.Seasonality_Analysis.R")
debugSource("~/Documents/GitHub/DESTv2_data_paper/11.Seasonality_Analysis/1.Seasonality_Analysis.R")
debugSource("~/Documents/GitHub/DESTv2_data_paper/11.Seasonality_Analysis/1.Seasonality_Analysis.R")
debugSource("~/Documents/GitHub/DESTv2_data_paper/11.Seasonality_Analysis/1.Seasonality_Analysis.R")
debugSource("~/Documents/GitHub/DESTv2_data_paper/11.Seasonality_Analysis/1.Seasonality_Analysis.R")
q
debugSource("~/Documents/GitHub/DESTv2_data_paper/11.Seasonality_Analysis/1.Seasonality_Analysis.R")
debugSource("~/Documents/GitHub/DESTv2_data_paper/11.Seasonality_Analysis/1.Seasonality_Analysis.R")
debugSource("~/Documents/GitHub/DESTv2_data_paper/11.Seasonality_Analysis/1.Seasonality_Analysis.R")
debugSource("~/Documents/GitHub/DESTv2_data_paper/11.Seasonality_Analysis/1.Seasonality_Analysis.R")
debugSource("~/Documents/GitHub/DESTv2_data_paper/11.Seasonality_Analysis/1.Seasonality_Analysis.R")
debugSource("~/Documents/GitHub/DESTv2_data_paper/11.Seasonality_Analysis/1.Seasonality_Analysis.R")
debugSource("~/Documents/GitHub/DESTv2_data_paper/11.Seasonality_Analysis/1.Seasonality_Analysis.R")
debugSource("~/Documents/GitHub/DESTv2_data_paper/11.Seasonality_Analysis/1.Seasonality_Analysis.R")
debugSource("~/Documents/GitHub/DESTv2_data_paper/11.Seasonality_Analysis/1.Seasonality_Analysis.R")
debugSource("~/Documents/GitHub/DESTv2_data_paper/11.Seasonality_Analysis/1.Seasonality_Analysis.R")
debugSource("~/Documents/GitHub/DESTv2_data_paper/11.Seasonality_Analysis/1.Seasonality_Analysis.R")
debugSource("~/Documents/GitHub/DESTv2_data_paper/11.Seasonality_Analysis/1.Seasonality_Analysis.R")
debugSource("~/Documents/GitHub/DESTv2_data_paper/11.Seasonality_Analysis/1.Seasonality_Analysis.R")
debugSource("~/Documents/GitHub/DESTv2_data_paper/11.Seasonality_Analysis/1.Seasonality_Analysis.R")
debugSource("~/Documents/GitHub/DESTv2_data_paper/11.Seasonality_Analysis/1.Seasonality_Analysis.R")
debugSource("~/Documents/GitHub/DESTv2_data_paper/11.Seasonality_Analysis/1.Seasonality_Analysis.R")
debugSource("~/Documents/GitHub/DESTv2_data_paper/11.Seasonality_Analysis/1.Seasonality_Analysis.R")
debugSource("~/Documents/GitHub/DESTv2_data_paper/11.Seasonality_Analysis/1.Seasonality_Analysis.R")
debugSource("~/Documents/GitHub/DESTv2_data_paper/11.Seasonality_Analysis/1.Seasonality_Analysis.R")
debugSource("~/Documents/GitHub/DESTv2_data_paper/11.Seasonality_Analysis/1.Seasonality_Analysis.R")
debugSource("~/Documents/GitHub/DESTv2_data_paper/11.Seasonality_Analysis/1.Seasonality_Analysis.R")
debugSource("~/Documents/GitHub/DESTv2_data_paper/11.Seasonality_Analysis/1.Seasonality_Analysis.R")
debugSource("~/Documents/GitHub/DESTv2_data_paper/11.Seasonality_Analysis/1.Seasonality_Analysis.R")
debugSource("~/Documents/GitHub/DESTv2_data_paper/11.Seasonality_Analysis/1.Seasonality_Analysis.R")
debugSource("~/Documents/GitHub/DESTv2_data_paper/11.Seasonality_Analysis/1.Seasonality_Analysis.R")
debugSource("~/Documents/GitHub/DESTv2_data_paper/11.Seasonality_Analysis/1.Seasonality_Analysis.R")
debugSource("~/Documents/GitHub/DESTv2_data_paper/11.Seasonality_Analysis/1.Seasonality_Analysis.R")
debugSource("~/Documents/GitHub/DESTv2_data_paper/11.Seasonality_Analysis/1.Seasonality_Analysis.R")
debugSource("~/Documents/GitHub/DESTv2_data_paper/11.Seasonality_Analysis/1.Seasonality_Analysis.R")
debugSource("~/Documents/GitHub/DESTv2_data_paper/11.Seasonality_Analysis/1.Seasonality_Analysis.R")
debugSource("~/Documents/GitHub/DESTv2_data_paper/11.Seasonality_Analysis/1.Seasonality_Analysis.R")
debugSource("~/Documents/GitHub/DESTv2_data_paper/11.Seasonality_Analysis/1.Seasonality_Analysis.R")
debugSource("~/Documents/GitHub/DESTv2_data_paper/11.Seasonality_Analysis/1.Seasonality_Analysis.R")
debugSource("~/Documents/GitHub/DESTv2_data_paper/11.Seasonality_Analysis/1.Seasonality_Analysis.R")
debugSource("~/Documents/GitHub/DESTv2_data_paper/11.Seasonality_Analysis/1.Seasonality_Analysis.R")
debugSource("~/Documents/GitHub/DESTv2_data_paper/11.Seasonality_Analysis/1.Seasonality_Analysis.R")
debugSource("~/Documents/GitHub/DESTv2_data_paper/11.Seasonality_Analysis/1.Seasonality_Analysis.R")
debugSource("~/Documents/GitHub/DESTv2_data_paper/11.Seasonality_Analysis/1.Seasonality_Analysis.R")
debugSource("~/Documents/GitHub/DESTv2_data_paper/11.Seasonality_Analysis/1.Seasonality_Analysis.R")
debugSource("~/Documents/GitHub/DESTv2_data_paper/11.Seasonality_Analysis/1.Seasonality_Analysis.R")
debugSource("~/Documents/GitHub/DESTv2_data_paper/11.Seasonality_Analysis/1.Seasonality_Analysis.R")
debugSource("~/Documents/GitHub/DESTv2_data_paper/11.Seasonality_Analysis/1.Seasonality_Analysis.R")
52676.84+45118.95
52676.84+45118.95
97795.79+48000
145795.8-122000
97047+50945+45118+52676+8400+14656
375-=250
375-250
70/9
7700*3
7700*2
15400*2
84000/9
9333*2
18666*2
55*2
56,484 + 56,880
56484 + 56880
9333*3
53900*2
32.5*55000
0.325*55000
17875*2
0.74 * 15000
0.074 * 15000
1110*2*1
1110*2*1
0.74 * 15000
0.074 * 30000
2220*2
5000 * 0.08
400*6
47000*0.47
22090+35750+4440+2400
5+3+3
11*6000
6000+3285+66000
3000+1200
75285+4200+12000
7*6
7*6000
11 * 6000
27999*0.47
30800*0.47
13159.53+14476
7966/4
4*50000
(4*50000)*(2.0e-9)
(4*50000)*(2.9e-9)
(4*50000)
### open metadata
samps <- get(load("/project/berglandlab/DEST2.0_working_data/joint.metadata.Rdata"))
pc.objc$eig[1:40,] %>%
as.data.frame() %>%
mutate(adj.perc = `percentage of variance`/40) %>%
mutate(selected_snps = round(adj.perc*40000,0)) ->
object.to.select.gims
fil.root = paste(root, fil, sep = "/")
dat.flt %>% filter(perm == perm.th, .combine = "rbind" ) -> tmp0
obs.data
library(data.table)
library(tidyverse)
library(magrittr)
library(foreach)
#### first download the current sample metadata form
samps <- fread("/Users/jcbnunez/Documents/GitHub/DESTv2/populationInfo/dest_v2.samps_25Feb2023.csv")
samps.old.dat = filter(samps, !is.na(sampleId_orig)
& set != "dgn"
)
file.targ = c(
"/Users/jcbnunez/Documents/GitHub/DEST-bio.github.io/assets/util/MD5/MD5_bed.gz.ALL.txt.csv",
"/Users/jcbnunez/Documents/GitHub/DEST-bio.github.io/assets/util/MD5/MD5_masked.sync.gz.ALL.txt.csv",
"/Users/jcbnunez/Documents/GitHub/DEST-bio.github.io/assets/util/MD5/MD5_SNAPE.monomorphic.masked.sync.gz.ALL.txt.csv "
)
foreach(input.txt = file.targ)%do%{ #### open i
foreach(i = 1:dim(samps.old.dat)[1])%do%{ #### open i
old.text=samps.old.dat$sampleId_orig[i]
new.text=samps.old.dat$sampleId[i]
set=samps.old.dat$set[i]
#input.txt=file.targ
message(paste("changing",old.text, "to",new.text, "set=",  set))
if(set != "dgn"){ ### set
system(
paste( "sed -i ''",
paste("'s/", old.text, "/", new.text, "/g'", sep = "") ,
input.txt,
sep = " ")
)
#system(
#  paste( "sed -i ''",
#         paste("'s|",
#               paste("/",old.text,"/",old.text, ".", sep = "") ,
#               "|",
#               paste("/",new.text,"/",new.text, ".",sep = "") ,
#               "|g'", sep = ""),
#         input.txt,
#         sep = " ")
#)
} ### set
#if(set == "dgn"){ ### set
#
#  system(
#    paste( "sed -i ''",
#           paste("'s/| ", old.text, "./| ", new.text, "./g'", sep = "") ,
#           input.txt,
#           sep = " ")
#  )
#
#  system(
#    paste( "sed -i ''",
#           paste("'s|",
#                 paste("DGN/",old.text,"/",old.text, ".", sep = "") ,
#                 "|",
#                 paste("DGN/",new.text,"/",new.text, ".",sep = "") ,
#                 "|g'", sep = ""),
#           input.txt,
#           sep = " ")
#  )
#
#} ### set
} #### close i
} #### close file targ
samps.old.dat.dgn = filter(samps, !is.na(sampleId_orig)
& set == "dgn"
)
foreach(input.txt = file.targ.dgn)%do%{ #### open i
foreach(i = 1:dim(samps.old.dat.dgn)[1])%do%{ #### open i
old.text=samps.old.dat.dgn$sampleId_orig[i]
new.text=samps.old.dat.dgn$sampleId[i]
set=samps.old.dat.dgn$set[i]
#input.txt=file.targ
message(paste("changing",old.text, "to",new.text, "set=",  set))
#if(set != "dgn"){ ### set
#
#  system(
#    paste( "sed -i ''",
#           paste("'s/", old.text, "/", new.text, "/g'", sep = "") ,
#           input.txt,
#           sep = " ")
#  )
#
#  #system(
#  paste( "sed -i ''",
#         paste("'s|",
#               paste("/",old.text,"/",old.text, ".", sep = "") ,
#               "|",
#               paste("/",new.text,"/",new.text, ".",sep = "") ,
#               "|g'", sep = ""),
#         input.txt,
#         sep = " ")
#)
# } ### set
if(set == "dgn"){ ### set
system(
paste( "sed -i ''",
paste("'s/| ", old.text, "./| ", new.text, "./g'", sep = "") ,
input.txt,
sep = " ")
)
system(
paste( "sed -i ''",
paste("'s|",
paste("DGN/",old.text,"/",old.text, ".", sep = "") ,
"|",
paste("DGN/",new.text,"/",new.text, ".",sep = "") ,
"|g'", sep = ""),
input.txt,
sep = " ")
)
} ### set
} #### close i
} #### close file targ
samps.old.dat.dgn
samps.old.dat.dgn = filter(samps, !is.na(sampleId_orig)
& set == "dgn"
)
samps.old.dat.dgn
file.targ.dgn = c("/Users/jcbnunez/Documents/GitHub/DEST-bio.github.io/assets/util/MD5/MD5_masked.sync.gz.justDGN.csv")
samps.old.dat.dgn = filter(samps, !is.na(sampleId_orig)
& set == "dgn"
)
foreach(input.txt = file.targ.dgn)%do%{ #### open i
foreach(i = 1:dim(samps.old.dat.dgn)[1])%do%{ #### open i
old.text=samps.old.dat.dgn$sampleId_orig[i]
new.text=samps.old.dat.dgn$sampleId[i]
set=samps.old.dat.dgn$set[i]
#input.txt=file.targ
message(paste("changing",old.text, "to",new.text, "set=",  set))
#if(set != "dgn"){ ### set
#
#  system(
#    paste( "sed -i ''",
#           paste("'s/", old.text, "/", new.text, "/g'", sep = "") ,
#           input.txt,
#           sep = " ")
#  )
#
#  #system(
#  paste( "sed -i ''",
#         paste("'s|",
#               paste("/",old.text,"/",old.text, ".", sep = "") ,
#               "|",
#               paste("/",new.text,"/",new.text, ".",sep = "") ,
#               "|g'", sep = ""),
#         input.txt,
#         sep = " ")
#)
# } ### set
if(set == "dgn"){ ### set
system(
paste( "sed -i ''",
paste("'s/| ", old.text, "./| ", new.text, "./g'", sep = "") ,
input.txt,
sep = " ")
)
system(
paste( "sed -i ''",
paste("'s|",
paste("DGN/",old.text,"/",old.text, ".", sep = "") ,
"|",
paste("DGN/",new.text,"/",new.text, ".",sep = "") ,
"|g'", sep = ""),
input.txt,
sep = " ")
)
} ### set
} #### close i
} #### close file targ
file.targ.dgn = c("/Users/jcbnunez/Documents/GitHub/DEST-bio.github.io/assets/util/MD5/MD5_masked.sync.gz.justDGN.csv")
file.targ.dgn
samps.old.dat.dgn
file.targ.dgn
samps.old.dat.dgn
old.text=samps.old.dat.dgn$sampleId_orig[i]
new.text=samps.old.dat.dgn$sampleId[i]
set=samps.old.dat.dgn$set[i]
#input.txt=file.targ
message(paste("changing",old.text, "to",new.text, "set=",  set))
paste( "sed -i ''",
paste("'s/| ", old.text, "./| ", new.text, "./g'", sep = "") ,
input.txt,
sep = " ")
system(
paste( "sed -i ''",
paste("'s/| ", old.text, "./| ", new.text, "./g'", sep = "") ,
input.txt,
sep = " ")
)
paste( "sed -i ''",
paste("'s|",
paste("DGN/",old.text,"/",old.text, ".", sep = "") ,
"|",
paste("DGN/",new.text,"/",new.text, ".",sep = "") ,
"|g'", sep = ""),
input.txt,
sep = " ")
foreach(input.txt = file.targ.dgn)%do%{ #### open i
foreach(i = 1:dim(samps.old.dat.dgn)[1])%do%{ #### open i
old.text=samps.old.dat.dgn$sampleId_orig[i]
new.text=samps.old.dat.dgn$sampleId[i]
set=samps.old.dat.dgn$set[i]
#input.txt=file.targ
message(paste("changing",old.text, "to",new.text, "set=",  set))
#if(set != "dgn"){ ### set
#
#  system(
#    paste( "sed -i ''",
#           paste("'s/", old.text, "/", new.text, "/g'", sep = "") ,
#           input.txt,
#           sep = " ")
#  )
#
#  #system(
#  paste( "sed -i ''",
#         paste("'s|",
#               paste("/",old.text,"/",old.text, ".", sep = "") ,
#               "|",
#               paste("/",new.text,"/",new.text, ".",sep = "") ,
#               "|g'", sep = ""),
#         input.txt,
#         sep = " ")
#)
# } ### set
#if(set == "dgn"){ ### set
system(
paste( "sed -i ''",
paste("'s/| ", old.text, "./| ", new.text, "./g'", sep = "") ,
input.txt,
sep = " ")
)
system(
paste( "sed -i ''",
paste("'s|",
paste("DGN/",old.text,"/",old.text, ".", sep = "") ,
"|",
paste("DGN/",new.text,"/",new.text, ".",sep = "") ,
"|g'", sep = ""),
input.txt,
sep = " ")
)
#} ### set
} #### close i
} #### close file targ
ac <- get(load(/Users/jcbnunez/Downloads/GLM.season_pop_by_year_All.SNPrange.16033.16533.Rdata
ac <- get(load("/Users/jcbnunez/Downloads/GLM.season_pop_by_year_All.SNPrange.16033.16533.Rdata
"))
ac <- get(load("/Users/jcbnunez/Downloads/GLM.season_pop_by_year_All.SNPrange.16033.16533.Rdata"))
ac
anchored.samp[complete.cases(anchored.samp),] %>% rownames() ->
GIMS.id.noNas
?dapc
samps.used.in.modeltrain$province
1361.40-1400
6641.07/12
1700/12
554+142
1479.00/12
554+124
700/12
qc.dat <- get(load("Miss.Cov.PCRdup.sim.joint.Rdata"))
load("/Users/jcbnunez/Downloads/final.calls.QC.Rdata")
ls()
final.calls
final.calls %>% tail
final.calls %>% tail(40)
final.calls %>% head(40)
10^1
10^-1
10^-2
?write.table
samp.i="aaa"
data.frame(samp.i, "Complete")
data.frame(s=samp.i, i="Complete")
fns <- system("ls /scratch/yey2sn/DEST2_analysis/filtering/sim_contam_final/*.Rdata", intern=T)
load("/Users/jcbnunez/Downloads/GLM_out.1.2L_5762_17762.Rdata")
o
780/4
setwd("/Users/jcbnunez/Documents/GitHub/Cville-Seasonality-2016-2019/REPRODUCIBLE_FIGURES/Fig1")
rm(list = ls())
library(tidyverse)
library(magrittr)
library(factoextra)
library(FactoMineR)
library(gtools)
library(patchwork)
library(reshape2)
library(ggrepel)
library(sp)
library(permute)
library(RColorBrewer)
library(data.table)
library(scales)
library(gmodels)
library(forcats)
library(poolfstat)
library(gdsfmt)
library(SNPRelate)
library(SeqArray)
library(gmodels)
library(MASS)
load("Fig1.panels.AB.dat.Rdata")
PCA_table
ls()
PCA_table
setwd("../Fig2")
ls -l
rm(list = ls())
# Load packages
#load packages
library(tidyverse)
library(magrittr)
library(factoextra)
library(FactoMineR)
library(gtools)
library(patchwork)
library(reshape2)
library(ggrepel)
library(sp)
library(permute)
library(RColorBrewer)
library(devtools)
library(lubridate)
library(vroom)
library(gdsfmt)
library(SNPRelate)
library(SeqArray)
library(data.table)
library(foreach)
library(doParallel)
library(viridis)
library(corrplot)
#library(gdata)
library(foreach)
library(doMC)
registerDoMC(5)
load("make.Fig2.panelA.Rdata")
ls()
pca_table_df
