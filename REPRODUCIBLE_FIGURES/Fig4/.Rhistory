st.p > 0.05 ~  st.lci)) %>%
mutate(concord.st.uci = case_when(st.p <= 0.05 ~  abs(st.uci-0.5)*2,
st.p > 0.05 ~  st.uci)) %>%
mutate(concord.st2 = case_when(st.pr <= 0.5 ~  st.pr + abs(st.pr-0.5)*2,
st.pr > 0.5 ~  st.pr ,
))
rbind(
#mutate(machado.datasets.enrch, set.type = "Machado"  ),
mutate(enrichment.sets, set.type = "DEST")) %>%
mutate(start=win.start,end=win.end) %>%
left_join(final.windows.pos) %>%
mutate(concord.st = case_when(st.p <= 0.05 ~  abs(st.pr-0.5)*2,
st.p > 0.05 ~  st.pr)) %>%
mutate(concord.st.lci = case_when(st.p <= 0.05 ~  abs(st.lci-0.5)*2,
st.p > 0.05 ~  st.lci)) %>%
mutate(concord.st.uci = case_when(st.p <= 0.05 ~  abs(st.uci-0.5)*2,
st.p > 0.05 ~  st.uci)) %>%
mutate(concord.st2 = case_when(st.pr <= 0.5 ~  st.pr + abs(st.pr-0.5)*2,
st.pr > 0.5 ~  st.pr )) %>%
mutate(concord.st2 = case_when(st.lci <= 0.5 ~  st.lci + abs(st.lci-0.5)*2,
st.lci > 0.5 ~  st.lci ))
rbind(
#mutate(machado.datasets.enrch, set.type = "Machado"  ),
mutate(enrichment.sets, set.type = "DEST")) %>%
mutate(start=win.start,end=win.end) %>%
left_join(final.windows.pos) %>%
mutate(concord.st = case_when(st.p <= 0.05 ~  abs(st.pr-0.5)*2,
st.p > 0.05 ~  st.pr)) %>%
mutate(concord.st.lci = case_when(st.p <= 0.05 ~  abs(st.lci-0.5)*2,
st.p > 0.05 ~  st.lci)) %>%
mutate(concord.st.uci = case_when(st.p <= 0.05 ~  abs(st.uci-0.5)*2,
st.p > 0.05 ~  st.uci)) %>%
mutate(concord.st2 = case_when(st.pr <= 0.5 ~  st.pr + abs(st.pr-0.5)*2,
st.pr > 0.5 ~  st.pr )) %>%
mutate(concord.st2.lci = case_when(st.lci <= 0.5 ~  st.lci + abs(st.lci-0.5)*2,
st.lci > 0.5 ~  st.lci ))
rbind(
#mutate(machado.datasets.enrch, set.type = "Machado"  ),
mutate(enrichment.sets, set.type = "DEST")) %>%
mutate(start=win.start,end=win.end) %>%
left_join(final.windows.pos) %>%
mutate(concord.st = case_when(st.p <= 0.05 ~  abs(st.pr-0.5)*2,
st.p > 0.05 ~  st.pr)) %>%
mutate(concord.st.lci = case_when(st.p <= 0.05 ~  abs(st.lci-0.5)*2,
st.p > 0.05 ~  st.lci)) %>%
mutate(concord.st.uci = case_when(st.p <= 0.05 ~  abs(st.uci-0.5)*2,
st.p > 0.05 ~  st.uci)) %>%
mutate(concord.st2 = case_when(st.pr <= 0.5 ~  st.pr + abs(st.pr-0.5)*2,
st.pr > 0.5 ~  st.pr )) %>%
mutate(concord.st2.lci = case_when(st.lci <= 0.5 ~  st.lci - abs(st.lci-0.5)*2,
st.lci > 0.5 ~  st.lci ))
rbind(
#mutate(machado.datasets.enrch, set.type = "Machado"  ),
mutate(enrichment.sets, set.type = "DEST")) %>%
mutate(start=win.start,end=win.end) %>%
left_join(final.windows.pos) %>%
mutate(concord.st = case_when(st.p <= 0.05 ~  abs(st.pr-0.5)*2,
st.p > 0.05 ~  st.pr)) %>%
mutate(concord.st.lci = case_when(st.p <= 0.05 ~  abs(st.lci-0.5)*2,
st.p > 0.05 ~  st.lci)) %>%
mutate(concord.st.uci = case_when(st.p <= 0.05 ~  abs(st.uci-0.5)*2,
st.p > 0.05 ~  st.uci)) %>%
mutate(concord.st2 = case_when(st.pr <= 0.5 ~  st.pr + abs(st.pr-0.5)*2,
st.pr > 0.5 ~  st.pr ))
rbind(
#mutate(machado.datasets.enrch, set.type = "Machado"  ),
mutate(enrichment.sets, set.type = "DEST")) %>%
mutate(start=win.start,end=win.end) %>%
left_join(final.windows.pos) %>%
mutate(concord.st = case_when(st.p <= 0.05 ~  abs(st.pr-0.5)*2,
st.p > 0.05 ~  st.pr)) %>%
mutate(concord.st.lci = case_when(st.p <= 0.05 ~  abs(st.lci-0.5)*2,
st.p > 0.05 ~  st.lci)) %>%
mutate(concord.st.uci = case_when(st.p <= 0.05 ~  abs(st.uci-0.5)*2,
st.p > 0.05 ~  st.uci)) %>%
mutate(concord.st2 = case_when(st.pr <= 0.5 ~  st.pr + abs(st.pr-0.5)*2,
st.pr > 0.5 ~  st.pr )) %>%
mutate(concord.st2.lci = case_when(st.lci <= 0.5 ~  abs(st.lci-0.5)*2,
st.lci > 0.5 ~  st.lci ))
rbind(
#mutate(machado.datasets.enrch, set.type = "Machado"  ),
mutate(enrichment.sets, set.type = "DEST")) %>%
mutate(start=win.start,end=win.end) %>%
left_join(final.windows.pos) %>%
mutate(concord.st = case_when(st.p <= 0.05 ~  abs(st.pr-0.5)*2,
st.p > 0.05 ~  st.pr)) %>%
mutate(concord.st.lci = case_when(st.p <= 0.05 ~  abs(st.lci-0.5)*2,
st.p > 0.05 ~  st.lci)) %>%
mutate(concord.st.uci = case_when(st.p <= 0.05 ~  abs(st.uci-0.5)*2,
st.p > 0.05 ~  st.uci)) %>%
mutate(concord.st2 = case_when(st.pr <= 0.5 ~  st.pr + abs(st.pr-0.5)*2,
st.pr > 0.5 ~  st.pr )) %>%
mutate(concord.st2.lci = case_when(st.lci <= 0.5 ~  abs(st.lci-0.5)*2,
st.lci > 0.5 ~  st.lci )) %>%
mutate(concord.st2.lci = case_when(st.uci <= 0.5 ~  abs(st.uci-0.5)*2,
st.uci > 0.5 ~  st.uci ))
rbind(
#mutate(machado.datasets.enrch, set.type = "Machado"  ),
mutate(enrichment.sets, set.type = "DEST")) %>%
mutate(start=win.start,end=win.end) %>%
left_join(final.windows.pos) %>%
mutate(concord.st = case_when(st.p <= 0.05 ~  abs(st.pr-0.5)*2,
st.p > 0.05 ~  st.pr)) %>%
mutate(concord.st.lci = case_when(st.p <= 0.05 ~  abs(st.lci-0.5)*2,
st.p > 0.05 ~  st.lci)) %>%
mutate(concord.st.uci = case_when(st.p <= 0.05 ~  abs(st.uci-0.5)*2,
st.p > 0.05 ~  st.uci)) %>%
mutate(concord.st2 = case_when(st.pr <= 0.5 ~  st.pr + abs(st.pr-0.5)*2,
st.pr > 0.5 ~  st.pr )) %>%
mutate(concord.st2.lci = case_when(st.lci <= 0.5 ~  abs(st.lci-0.5)*2,
st.lci > 0.5 ~  st.lci )) %>%
mutate(concord.st2.uci = case_when(st.uci <= 0.5 ~  abs(st.uci-0.5)*2,
st.uci > 0.5 ~  st.uci ))
rbind(
#mutate(machado.datasets.enrch, set.type = "Machado"  ),
mutate(enrichment.sets, set.type = "DEST")) %>%
mutate(start=win.start,end=win.end) %>%
left_join(final.windows.pos) %>%
mutate(concord.st = case_when(st.p <= 0.05 ~  abs(st.pr-0.5)*2,
st.p > 0.05 ~  st.pr)) %>%
mutate(concord.st.lci = case_when(st.p <= 0.05 ~  abs(st.lci-0.5)*2,
st.p > 0.05 ~  st.lci)) %>%
mutate(concord.st.uci = case_when(st.p <= 0.05 ~  abs(st.uci-0.5)*2,
st.p > 0.05 ~  st.uci)) %>%
mutate(concord.st2 = case_when(st.pr <= 0.5 ~  st.pr + abs(st.pr-0.5)*2,
st.pr > 0.5 ~  st.pr )) %>%
mutate(concord.st2.lci = case_when(st.lci <= 0.5 ~  abs(st.lci-0.5)*2,
st.lci > 0.5 ~  st.lci )) %>%
mutate(concord.st2.uci = case_when(st.uci <= 0.5 ~  abs(st.uci-0.5)*2,
st.uci > 0.5 ~  st.uci )) %>%
group_by(anchor.model, win.name) %>%
mutate(conc.min = min(concord.st2.lci, concord.st2.uci))
rbind(
#mutate(machado.datasets.enrch, set.type = "Machado"  ),
mutate(enrichment.sets, set.type = "DEST")) %>%
mutate(start=win.start,end=win.end) %>%
left_join(final.windows.pos) %>%
mutate(concord.st = case_when(st.p <= 0.05 ~  abs(st.pr-0.5)*2,
st.p > 0.05 ~  st.pr)) %>%
mutate(concord.st.lci = case_when(st.p <= 0.05 ~  abs(st.lci-0.5)*2,
st.p > 0.05 ~  st.lci)) %>%
mutate(concord.st.uci = case_when(st.p <= 0.05 ~  abs(st.uci-0.5)*2,
st.p > 0.05 ~  st.uci)) %>%
mutate(concord.st2 = case_when(st.pr <= 0.5 ~  st.pr + abs(st.pr-0.5)*2,
st.pr > 0.5 ~  st.pr )) %>%
mutate(concord.st2.lci = case_when(st.lci <= 0.5 ~  abs(st.lci-0.5)*2,
st.lci > 0.5 ~  st.lci )) %>%
mutate(concord.st2.uci = case_when(st.uci <= 0.5 ~  abs(st.uci-0.5)*2,
st.uci > 0.5 ~  st.uci )) %>%
group_by(anchor.model, win.name) %>%
mutate(conc.min = min(concord.st2.lci, concord.st2.uci)) %>% as.data.frame()
rbind(
#mutate(machado.datasets.enrch, set.type = "Machado"  ),
mutate(enrichment.sets, set.type = "DEST")) %>%
mutate(start=win.start,end=win.end) %>%
left_join(final.windows.pos) %>%
mutate(concord.st = case_when(st.pr <= 0.5 ~  st.pr + abs(st.pr-0.5)*2,
st.pr > 0.5 ~  st.pr )) %>%
mutate(concord.st.lci = case_when(st.lci <= 0.5 ~  abs(st.lci-0.5)*2,
st.lci > 0.5 ~  st.lci )) %>%
mutate(concord.st.uci = case_when(st.uci <= 0.5 ~  abs(st.uci-0.5)*2,
st.uci > 0.5 ~  st.uci )) %>%
group_by(anchor.model, win.name) %>%
mutate(conc.min = min(concord.st.lci, concord.st.uci),
conc.max = max(concord.st.lci, concord.st.uci),) %>% as.data.frame()
rbind(
#mutate(machado.datasets.enrch, set.type = "Machado"  ),
mutate(enrichment.sets, set.type = "DEST")) %>%
mutate(start=win.start,end=win.end) %>%
left_join(final.windows.pos) %>%
mutate(concord.st = case_when(st.pr <= 0.5 ~  st.pr + abs(st.pr-0.5)*2,
st.pr > 0.5 ~  st.pr )) %>%
mutate(concord.st.lci = case_when(st.lci <= 0.5 ~  abs(st.lci-0.5)*2,
st.lci > 0.5 ~  st.lci )) %>%
mutate(concord.st.uci = case_when(st.uci <= 0.5 ~  abs(st.uci-0.5)*2,
st.uci > 0.5 ~  st.uci )) %>%
group_by(anchor.model, win.name) %>%
mutate(conc.min = min(concord.st.lci, concord.st.uci),
conc.max = max(concord.st.lci, concord.st.uci),) %>%
#group_by(anchor.model, win.name) %>%
#mutate(Consistency = (max(st.pr, 1-st.pr) - 0.5)*2) %>%
#mutate(Consistency.u = (max(st.uci, 1-st.uci) - 0.5)*2) %>%
#mutate(Consistency.l = (max(st.lci, 1-st.lci) - 0.5)*2) %>%
#filter(analysis_type == "best_model") %>%
#separate(anchor.model, into = c("model", "resolution.mod", "demo.region"), sep = ";" ) %>%
ggplot(aes(
x=win.name,
y=concord.st,
ymin=conc.min,
ymax=conc.max,
color = anchor.model,
fill = anchor.model,
)) +
geom_hline(yintercept = 0.5) +
geom_errorbar(size = 0.5, width = 0.25, position=position_dodge(width=0.5)) +
geom_point(size = 2.0, shape = 21, position=position_dodge(width=0.5), color = "black") +
theme_bw() +
facet_grid(set.type~., scales = "free_y") +
theme(legend.pos = "bottom") +
ylab("Consistency")
rbind(
#mutate(machado.datasets.enrch, set.type = "Machado"  ),
mutate(enrichment.sets, set.type = "DEST")) %>%
mutate(start=win.start,end=win.end) %>%
left_join(final.windows.pos) %>%
group_by(anchor.model, win.name) %>%
mutate(Consistency = (max(st.pr, 1-st.pr) - 0.5)*2) %>%
mutate(Consistency.u = (max(st.uci, 1-st.uci) - 0.5)*2) %>%
mutate(Consistency.l = (max(st.lci, 1-st.lci) - 0.5)*2) %>%
mutate(
conc.min = min(Consistency.u, Consistency.l),
conc.max = max(Consistency.u, Consistency.l)) %>%
#filter(analysis_type == "best_model") %>%
#separate(anchor.model, into = c("model", "resolution.mod", "demo.region"), sep = ";" ) %>%
ggplot(aes(
x=win.name,
y=Consistency,
ymin=conc.min,
ymax=conc.max,
color = anchor.model,
fill = anchor.model,
)) +
geom_hline(yintercept = 0.5) +
geom_errorbar(size = 0.5, width = 0.25, position=position_dodge(width=0.5)) +
geom_point(size = 2.0, shape = 21, position=position_dodge(width=0.5), color = "black") +
theme_bw() +
facet_grid(set.type~., scales = "free_y") +
theme(legend.pos = "bottom") +
ylab("Consistency")
rbind(
#mutate(machado.datasets.enrch, set.type = "Machado"  ),
mutate(enrichment.sets, set.type = "DEST")) %>%
mutate(start=win.start,end=win.end) %>%
left_join(final.windows.pos) %>%
group_by(anchor.model, win.name) %>%
mutate(Consistency = (max(st.pr, 1-st.pr) - 0.5)) %>%
mutate(Consistency.u = (max(st.uci, 1-st.uci) - 0.5)) %>%
mutate(Consistency.l = (max(st.lci, 1-st.lci) - 0.5)) %>%
mutate(
conc.min = min(Consistency.u, Consistency.l),
conc.max = max(Consistency.u, Consistency.l)) %>%
#filter(analysis_type == "best_model") %>%
#separate(anchor.model, into = c("model", "resolution.mod", "demo.region"), sep = ";" ) %>%
ggplot(aes(
x=win.name,
y=Consistency,
ymin=conc.min,
ymax=conc.max,
color = anchor.model,
fill = anchor.model,
)) +
geom_hline(yintercept = 0.5) +
geom_errorbar(size = 0.5, width = 0.25, position=position_dodge(width=0.5)) +
geom_point(size = 2.0, shape = 21, position=position_dodge(width=0.5), color = "black") +
theme_bw() +
facet_grid(set.type~., scales = "free_y") +
theme(legend.pos = "bottom") +
ylab("Consistency")
rbind(
#mutate(machado.datasets.enrch, set.type = "Machado"  ),
mutate(enrichment.sets, set.type = "DEST")) %>%
mutate(start=win.start,end=win.end) %>%
left_join(final.windows.pos) %>%
group_by(anchor.model, win.name) %>%
mutate(Consistency = (max(st.pr, 1-st.pr) - 0.5)) %>%
mutate(Consistency.u = (max(st.uci, 1+st.uci) - 0.5)) %>%
mutate(Consistency.l = (max(st.lci, 1-st.lci) - 0.5)) %>%
mutate(
conc.min = min(Consistency.u, Consistency.l),
conc.max = max(Consistency.u, Consistency.l)) %>%
#filter(analysis_type == "best_model") %>%
#separate(anchor.model, into = c("model", "resolution.mod", "demo.region"), sep = ";" ) %>%
ggplot(aes(
x=win.name,
y=Consistency,
ymin=conc.min,
ymax=conc.max,
color = anchor.model,
fill = anchor.model,
)) +
geom_hline(yintercept = 0.5) +
geom_errorbar(size = 0.5, width = 0.25, position=position_dodge(width=0.5)) +
geom_point(size = 2.0, shape = 21, position=position_dodge(width=0.5), color = "black") +
theme_bw() +
facet_grid(set.type~., scales = "free_y") +
theme(legend.pos = "bottom") +
ylab("Consistency")
rbind(
#mutate(machado.datasets.enrch, set.type = "Machado"  ),
mutate(enrichment.sets, set.type = "DEST")) %>%
mutate(start=win.start,end=win.end) %>%
left_join(final.windows.pos) %>%
group_by(anchor.model, win.name) %>%
mutate(Consistency = (max(st.pr, 1-st.pr) - 0.5)) %>%
mutate(Consistency.u = (max(st.uci, 1-st.uci) - 0.5)) %>%
mutate(Consistency.l = (max(st.lci, 1+st.lci) - 0.5)) %>%
mutate(
conc.min = min(Consistency.u, Consistency.l),
conc.max = max(Consistency.u, Consistency.l)) %>%
#filter(analysis_type == "best_model") %>%
#separate(anchor.model, into = c("model", "resolution.mod", "demo.region"), sep = ";" ) %>%
ggplot(aes(
x=win.name,
y=Consistency,
ymin=conc.min,
ymax=conc.max,
color = anchor.model,
fill = anchor.model,
)) +
geom_hline(yintercept = 0.5) +
geom_errorbar(size = 0.5, width = 0.25, position=position_dodge(width=0.5)) +
geom_point(size = 2.0, shape = 21, position=position_dodge(width=0.5), color = "black") +
theme_bw() +
facet_grid(set.type~., scales = "free_y") +
theme(legend.pos = "bottom") +
ylab("Consistency")
rbind(
#mutate(machado.datasets.enrch, set.type = "Machado"  ),
mutate(enrichment.sets, set.type = "DEST")) %>%
mutate(start=win.start,end=win.end) %>%
left_join(final.windows.pos) %>%
group_by(anchor.model, win.name) %>%
mutate(Consistency = (max(st.pr, 1-st.pr) - 0.5)) %>%
mutate(Consistency.u = (max(st.uci, 1-st.uci) - 0.5)) %>%
mutate(Consistency.l = (max(st.lci, 1-st.lci) - 0.5)) %>%
mutate(
conc.min = min(Consistency.u, Consistency.l),
conc.max = max(Consistency.u, Consistency.l)) %>%
#filter(analysis_type == "best_model") %>%
#separate(anchor.model, into = c("model", "resolution.mod", "demo.region"), sep = ";" ) %>%
ggplot(aes(
x=win.name,
y=Consistency,
ymin=conc.min,
ymax=conc.max,
color = anchor.model,
fill = anchor.model,
)) +
geom_hline(yintercept = 0.5) +
geom_errorbar(size = 0.5, width = 0.25, position=position_dodge(width=0.5)) +
geom_point(size = 2.0, shape = 21, position=position_dodge(width=0.5), color = "black") +
theme_bw() +
facet_grid(set.type~., scales = "free_y") +
theme(legend.pos = "bottom") +
ylab("Consistency")
rbind(
#mutate(machado.datasets.enrch, set.type = "Machado"  ),
mutate(enrichment.sets, set.type = "DEST")) %>%
mutate(start=win.start,end=win.end) %>%
left_join(final.windows.pos) %>%
mutate(concord.st = case_when(st.pr <= 0.5 ~  st.pr + abs(st.pr-0.5)*2,
st.pr > 0.5 ~  st.pr )) %>%
mutate(concord.st.lci = case_when(st.lci <= 0.5 ~  abs(st.lci-0.5)*2,
st.lci > 0.5 ~  st.lci )) %>%
mutate(concord.st.uci = case_when(st.uci <= 0.5 ~  abs(st.uci-0.5)*2,
st.uci > 0.5 ~  st.uci )) %>%
group_by(anchor.model, win.name)
rbind(
#mutate(machado.datasets.enrch, set.type = "Machado"  ),
mutate(enrichment.sets, set.type = "DEST")) %>%
mutate(start=win.start,end=win.end) %>%
left_join(final.windows.pos) %>%
mutate(concord.st = case_when(st.pr <= 0.5 ~  st.pr + abs(st.pr-0.5)*2,
st.pr > 0.5 ~  st.pr )) %>%
mutate(concord.st.lci = case_when(st.lci <= 0.5 ~  abs(st.lci-0.5)*2,
st.lci > 0.5 ~  st.lci )) %>%
mutate(concord.st.uci = case_when(st.uci <= 0.5 ~  abs(st.uci-0.5)*2,
st.uci > 0.5 ~  st.uci )) %>%
group_by(anchor.model, win.name) %>% as.data.frame()
rbind(
#mutate(machado.datasets.enrch, set.type = "Machado"  ),
mutate(enrichment.sets, set.type = "DEST")) %>%
mutate(start=win.start,end=win.end) %>%
left_join(final.windows.pos) %>%
mutate(concord.st = case_when(st.pr <= 0.5 ~  st.pr + abs(st.pr-0.5)*2,
st.pr > 0.5 ~  st.pr )) %>%
mutate(concord.st.lci = case_when(st.lci <= 0.5 ~  abs(st.lci-0.5)*2,
st.lci > 0.5 ~  st.lci )) %>%
mutate(concord.st.uci = case_when(st.uci <= 0.5 ~  abs(st.uci-0.5)*2,
st.uci > 0.5 ~  st.uci )) %>%
group_by(anchor.model, win.name) %>% as.data.frame()
mutate(conc.min = min(concord.st.lci, concord.st.uci),
conc.max = max(concord.st.lci, concord.st.uci),) %>% as.data.frame()
rbind(
#mutate(machado.datasets.enrch, set.type = "Machado"  ),
mutate(enrichment.sets, set.type = "DEST")) %>%
mutate(start=win.start,end=win.end) %>%
left_join(final.windows.pos) %>%
mutate(concord.st = case_when(st.pr <= 0.5 ~  st.pr + abs(st.pr-0.5)*2,
st.pr > 0.5 ~  st.pr )) %>%
mutate(concord.st.lci = case_when(st.lci <= 0.5 ~  abs(st.lci-0.5)*2,
st.lci > 0.5 ~  st.lci )) %>%
mutate(concord.st.uci = case_when(st.uci <= 0.5 ~  abs(st.uci-0.5)*2,
st.uci > 0.5 ~  st.uci )) %>%
group_by(anchor.model, win.name) %>%
mutate(conc.min = min(concord.st.lci, concord.st.uci),
conc.max = max(concord.st.lci, concord.st.uci)) %>% as.data.frame()
rbind(
#mutate(machado.datasets.enrch, set.type = "Machado"  ),
mutate(enrichment.sets, set.type = "DEST")) %>%
mutate(start=win.start,end=win.end) %>%
left_join(final.windows.pos) %>%
mutate(concord.st = case_when(st.pr <= 0.5 ~  st.pr + abs(st.pr-0.5)*2,
st.pr > 0.5 ~  st.pr )) %>%
mutate(concord.st.lci = case_when(st.lci <= 0.5 ~  abs(st.lci-0.5)*2,
st.lci > 0.5 ~  st.lci )) %>%
mutate(concord.st.uci = case_when(st.uci <= 0.5 ~  abs(st.uci-0.5)*2,
st.uci > 0.5 ~  st.uci )) %>%
group_by(anchor.model, win.name) %>%
mutate(conc.min = min(concord.st.lci, concord.st.uci),
conc.max = max(concord.st.lci, concord.st.uci)) %>%
#group_by(anchor.model, win.name) %>%
#mutate(Consistency = (max(st.pr, 1-st.pr) - 0.5)*2) %>%
#mutate(Consistency.u = (max(st.uci, 1-st.uci) - 0.5)*2) %>%
#mutate(Consistency.l = (max(st.lci, 1-st.lci) - 0.5)*2) %>%
#filter(analysis_type == "best_model") %>%
#separate(anchor.model, into = c("model", "resolution.mod", "demo.region"), sep = ";" ) %>%
ggplot(aes(
x=win.name,
y=concord.st,
ymin=conc.min,
ymax=conc.max,
color = anchor.model,
fill = anchor.model,
)) +
geom_hline(yintercept = 0.5) +
geom_errorbar(size = 0.5, width = 0.25, position=position_dodge(width=0.5)) +
geom_point(size = 2.0, shape = 21, position=position_dodge(width=0.5), color = "black") +
theme_bw() +
facet_grid(set.type~., scales = "free_y") +
theme(legend.pos = "bottom") +
ylab("Consistency")
rbind(
#mutate(machado.datasets.enrch, set.type = "Machado"  ),
mutate(enrichment.sets, set.type = "DEST")) %>%
mutate(start=win.start,end=win.end) %>%
left_join(final.windows.pos) %>%
mutate(concord.st = case_when(st.pr <= 0.5 ~  st.pr + abs(st.pr-0.5)*2,
st.pr > 0.5 ~  st.pr )) %>%
mutate(concord.st.lci = case_when(st.lci <= 0.5 ~  abs(st.lci-0.5)*2,
st.lci > 0.5 ~  st.lci )) %>%
mutate(concord.st.uci = case_when(st.uci <= 0.5 ~  abs(st.uci-0.5)*2,
st.uci > 0.5 ~  st.uci )) %>%
group_by(anchor.model, win.name) %>%
#mutate(conc.min = min(concord.st.lci, concord.st.uci),
#       conc.max = max(concord.st.lci, concord.st.uci)) %>%
#group_by(anchor.model, win.name) %>%
#mutate(Consistency = (max(st.pr, 1-st.pr) - 0.5)*2) %>%
#mutate(Consistency.u = (max(st.uci, 1-st.uci) - 0.5)*2) %>%
#mutate(Consistency.l = (max(st.lci, 1-st.lci) - 0.5)*2) %>%
#filter(analysis_type == "best_model") %>%
#separate(anchor.model, into = c("model", "resolution.mod", "demo.region"), sep = ";" ) %>%
ggplot(aes(
x=win.name,
y=concord.st,
ymin=concord.st.lci,
ymax=concord.st.uci,
color = anchor.model,
fill = anchor.model,
)) +
geom_hline(yintercept = 0.5) +
geom_errorbar(size = 0.5, width = 0.25, position=position_dodge(width=0.5)) +
geom_point(size = 2.0, shape = 21, position=position_dodge(width=0.5), color = "black") +
theme_bw() +
facet_grid(set.type~., scales = "free_y") +
theme(legend.pos = "bottom") +
ylab("Consistency")
enrichment.sets
rbind(
#mutate(machado.datasets.enrch, set.type = "Machado"  ),
mutate(enrichment.sets, set.type = "DEST")) %>%
mutate(start=win.start,end=win.end) %>%
left_join(final.windows.pos) %>%
ggplot(aes(
x=win.name,
y=st.pr,
ymin=st.lci,
ymax=st.uci,
color = anchor.model,
fill = anchor.model,
)) +
geom_hline(yintercept = 0.5) +
geom_errorbar(size = 0.5, width = 0.25, position=position_dodge(width=0.5)) +
geom_point(size = 2.0, shape = 21, position=position_dodge(width=0.5), color = "black") +
theme_bw() +
facet_grid(set.type~., scales = "free_y") +
theme(legend.pos = "bottom") +
ylab("Consistency") ->
dir.plot
dir.plot
rbind(
#mutate(machado.datasets.enrch, set.type = "Machado"  ),
mutate(enrichment.sets, set.type = "DEST")) %>%
mutate(start=win.start,end=win.end) %>%
left_join(final.windows.pos) %>%
ggplot(aes(
x=win.name,
y=st.pr,
ymin=st.lci,
ymax=st.uci,
color = anchor.model,
fill = anchor.model,
)) +
geom_hline(yintercept = 0.5) +
geom_errorbar(size = 0.5, width = 0.25, position=position_dodge(width=0.5)) +
geom_point(size = 2.0, shape = 21, position=position_dodge(width=0.5), color = "black") +
theme_bw() +
facet_grid(set.type~., scales = "free_y") +
theme(legend.pos = "bottom") +
ylab("Directionality") ->
dir.plot
ggsave(enrich.plot/dir.plot, file = "dir.plot.pdf", w = 4.0, h = 4.0)
